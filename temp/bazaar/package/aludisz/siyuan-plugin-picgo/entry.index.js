var wt=Object.defineProperty;var vt=(n,e,t)=>e in n?wt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var $=(n,e,t)=>(vt(n,typeof e!="symbol"?e+"":e,t),t);import{w as Ct}from"./chunks/chunk.vendor_zhi-lib-base.js";import{u as St,c as kt}from"./chunks/chunk.vendor_vue-i18n.js";import{K as z,L as h,M as x,bB as It,bC as xt,A as j,U as f,Z as k,u as c,X as Y,bD as We,bE as De,$ as p,O as Ge,E as Ot,R,S as m,W as Ut,aA as we,a4 as ie,bF as Lt,bG as Xe,bH as $t,q as Ze,t as ve,v as Ce,B as Je,aS as Ke,aq as de,Y as E,_ as Z,aC as ce,aI as Ve,H as Re,y as et,V as ye,T as Et,af as Ye,bI as V,bJ as Nt,bK as Tt,bL as Bt,bM as At,bN as Mt,bO as Wt,bP as Dt,bQ as Gt,bR as Vt,bS as Rt,bT as Ft,bU as jt,bV as qt,bW as Ht,bX as zt,bY as Jt,bZ as Kt,b_ as Yt,b$ as Qt,c0 as Xt,c1 as Zt,c2 as en,c3 as tn,c4 as nn,c5 as on,aM as sn}from"./chunks/chunk.vendor.js";import{Q as tt,M as be,d as nt,T as _e}from"./chunks/chunk.vendor_zhi-common.js";import{u as Se,a as Te,c as an,b as cn}from"./chunks/chunk.vendor_vue-router.js";import{T as he,d as le,u as W,n as oe}from"./chunks/chunk.vendor_zhi-device.js";import{E as A,a as ke,b as me,c as se,d as Fe,e as ln,f as re,g as gn,h as je,i as Ie,j as rn,k as pn,l as xe,m as it,n as un,o as dn,p as fn,v as mn,q as _n,r as hn,s as yn,t as Oe,u as bn,w as ot,x as st}from"./chunks/chunk.vendor_element-plus.js";import{m as Pn}from"./chunks/chunk.vendor_blueimp-md5-es6.js";import{d as at,c as wn}from"./chunks/chunk.vendor_pinia.js";import{n as ct,i as vn,g as Cn}from"./chunks/chunk.vendor_zhi-siyuan-api.js";import{l as Sn}from"./chunks/chunk.vendor_lodash.js";import{v as kn}from"./chunks/chunk.vendor_uuid.js";import{n as In}from"./chunks/chunk.vendor_browser-fs-access.js";import{j as xn,u as On}from"./chunks/chunk.vendor_lodash-es.js";import"./chunks/chunk.vendor_async-validator.js";import"./chunks/chunk.vendor_vue-demi.js";import"./chunks/chunk.vendor_dayjs.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(o){if(o.ep)return;o.ep=!0;const s=t(o);fetch(o.href,s)}})();const lt=!1;typeof window>"u"?global.console=console:window.console=window.console;const q=n=>Ct(n,"picgo-plugin-app",lt),Q=()=>{const{messages:n,locale:e}=St();return{t:i=>{var s;return((s=n.value)==null?void 0:s[e.value])[i]||i},locale:e}},Un={class:"header-default"},Ln=z({__name:"DefaultHeader",setup(n){return Q(),(e,t)=>(h(),x("div",Un))}}),$n="1.5.1",ee=()=>{const n=q("use-siyuan-device");return{isInSiyuanMainWin:()=>{const s=he.getDevice(),a=s===le.DeviceType_Siyuan_MainWin;return n.debug("deviceType=>",s),n.debug("isSiyuanOrSiyuanNewWin=>",String(a)),a},isInSiyuanWidget:()=>{const s=he.getDevice(),a=s===le.DeviceType_Siyuan_Widget;return n.debug("deviceType=>",s),n.debug("isSiyuanOrSiyuanNewWin=>",String(a)),a},isInChromeExtension:()=>{const s=he.getDevice(),a=s===le.DeviceType_Chrome_Extension;return n.debug("deviceType=>",s),n.debug("isSiyuanOrSiyuanNewWin=>",String(a)),a},isInSiyuanOrSiyuanNewWin:()=>{const s=he.getDevice(),a=s===le.DeviceType_Siyuan_MainWin||s===le.DeviceType_Siyuan_NewWin||s===le.DeviceType_Siyuan_Widget;return n.debug("deviceType=>",s),n.debug("isSiyuanOrSiyuanNewWin=>",String(a)),a}}},gt=n=>(We("data-v-d7ca339c"),n=n(),De(),n),En={class:"footer"},Nn={class:"text"},Tn={class:"text"},Bn=gt(()=>f("span",{class:"text"},".",-1)),An={key:0,class:"text"},Mn=gt(()=>f("span",{class:"text"},".",-1)),Wn=z({__name:"DefaultFooter",setup(n){const{t:e}=Q(),t=Se(),{isInSiyuanOrSiyuanNewWin:i}=ee(),o=It(),s=xt(o),a=j($n),l=tt.nowYear(),d=i(),g=()=>{window.open("https://github.com/terwer/siyuan-plugin-picgo")},y=()=>{window.open("https://blog.terwer.space/about")},u=async()=>{await t.push({path:"/setting/transport",query:{showBack:"true"}})},P=async()=>{await t.push({path:"/setting/siyuan",query:{showBack:"true"}})};return(w,r)=>(h(),x("div",null,[f("div",En,[f("div",null,[f("span",Nn," ©2011-"+k(c(l)),1),f("span",{class:"text s-dark",onClick:r[0]||(r[0]=_=>g())}," siyuan-plugin-picgo "),f("span",Tn,"v"+k(a.value)+" ",1),f("span",{class:"text s-dark",onClick:r[1]||(r[1]=_=>y())},k(c(e)("syp.about")),1),Bn,f("span",{class:"text s-dark",onClick:r[2]||(r[2]=_=>c(s)())},k(c(o)?c(e)("theme.mode.light"):c(e)("theme.mode.dark")),1),c(d)?(h(),x("span",An,".")):Y("",!0),c(d)?(h(),x("span",{key:1,class:"text s-dark",onClick:u},k(c(e)("setting.conf.transport")),1)):Y("",!0),Mn,f("span",{class:"text s-dark",onClick:P},k(c(e)("siyuan.config.setting")),1)])])]))}});const te=(n,e)=>{const t=n.__vccOpts||n;for(const[i,o]of e)t[i]=o;return t},Dn=te(Wn,[["__scopeId","data-v-d7ca339c"]]),Gn={id:"app-layout-default"},Vn={class:"default-main"},Rn=z({__name:"AppLayoutDefault",setup(n){return(e,t)=>(h(),x("div",Gn,[p(Ln),f("div",Vn,[Ge(e.$slots,"default",{},void 0,!0)]),p(Dn)]))}});const Fn=te(Rn,[["__scopeId","data-v-79213a22"]]),jn=z({__name:"AppLayout",setup(n){const e=Ot(Fn);return(t,i)=>(h(),R(Ut(e.value),null,{default:m(()=>[Ge(t.$slots,"default")]),_:3}))}});const qn=z({__name:"App",setup(n){return(e,t)=>{const i=we("router-view");return h(),R(jn,null,{default:m(()=>[p(i)]),_:1})}}}),Hn=()=>{const{isInSiyuanOrSiyuanNewWin:n}=ee(),e=ie({isUploadLoading:!1,popWidth:400,showDebugMsg:lt,loggerMsg:"",isSiyuanOrSiyuanNewWin:n(),fileList:{files:[]}});return{picgoCommonData:e,picgoCommonMethods:{getPicgoCommonData:()=>e}}},zn=n=>Pn(n);class ue{constructor(e,t,i,o,s){$(this,"name");$(this,"hash");$(this,"originUrl");$(this,"url");$(this,"alt");$(this,"title");$(this,"isLocal");this.originUrl=e,this.name=e.substring(e.lastIndexOf("/")+1),this.hash=zn(this.name),this.url=t,this.isLocal=i,this.alt=o??"",this.title=s??""}}class rt{constructor(){$(this,"logger",q("image-parser"))}hasExternalImages(e){const i=/!\[.*]\((http|https):\/.*\/.*\)/g,o=e.match(i);if(o!=null&&o.length>0)return!0;const s=/!\[.*]\((data:image):\/.*\/.*\)/g,a=e.match(s);return a!=null&&a.length>0}removeImages(e){let t=e;return t=t.replace(/!\[.*]\((http|https):\/.*\/.*\)/g,""),t}parseImagesToArray(e){let t=[];const i=this.parseRemoteImagesToArray(e),o=this.parseLocalImagesToArray(e);return t=[...new Set([...i,...o])],t}parseRemoteImagesToArray(e){this.logger.debug("准备解析文本中的远程图片=>",e);const t=/!\[(.*?)\]\((https?:\/\/\S+\.(?:jpe?g|png|gif))(?:\s+"(?:[^"\\]|\\.)*")?\s*(?:{:\s*([^\n]*)})?\)/g,i=[];for(const o of e.matchAll(t)){const s=o[1]?o[1]:"",a=o[2]?o[2]:"",l=o[3]?o[3].replace(/"/g,""):"";i.push({url:a,alt:s,title:l,isLocal:!1})}return this.logger.debug("远程图片解析完毕.",i),i}parseLocalImagesToArray(e){this.logger.debug("准备解析文本中的本地图片=>",e);const t=/!\[(.*?)\]\(((?!http|https|ftp)assets\/.*?)\s*("(?:[^"\\]|\\.)*")?\s*(\{(?:[^"\\]|\\.)*\})?\)/g,i=[];for(const o of e.matchAll(t)){const s=o[1]?o[1]:"",a=o[2]?o[2]:"",l=o[3]?o[3].replace(/"/g,""):"";i.push({url:a,alt:s,title:l,isLocal:!0})}return this.logger.debug("本地图片解析完毕.",i),i}replaceImagesWithImageItemArray(e,t){let i=e;const o=/!\[.*]\(assets\/.*\..*\)/g,s=i.match(o);if(s==null||s.length===0)return this.logger.warn("未匹配到本地图片，将不会替换图片链接"),i;for(let a=0;a<s.length;a++){const l=s[a];this.logger.debug("img=>",l);const d=l.replace(/!\[.*]\(/g,"").replace(/\)/,"");this.logger.debug("src=>",d);let g,y;const u=d.split(" ");u.length>1?(g=u[0],y=u[1].replace(/"/g,"")):g=u[0];const w=new ue(g,"",!0).hash,r=t[w],_=(r==null?void 0:r.alt)??"";let b=`![${_}](${r==null?void 0:r.url})`;y&&(b=`![${_}](${r==null?void 0:r.url} "${y}")`),this.logger.debug("newImg=>",b),i=i.replaceAll(l,b)}return i}}class Jn{constructor(){$(this,"flag");$(this,"hasImages");$(this,"mdContent");$(this,"errmsg")}}const Kn="custom-picgo-file-map-key",pe={PICGO_FILE_MAP_KEY:Kn},ne=class ne{constructor(){$(this,"isSiyuanOrSiyuanNewWin");$(this,"syPicgo")}static async getInstance(){if(!ne.instance){this.logger.info("Unable to obtain appInstance, try to re-initialized"),ne.instance=new ne;const{isInSiyuanOrSiyuanNewWin:e}=ee();ne.instance.isSiyuanOrSiyuanNewWin=e(),await ne.instance.init(),this.logger.info("SyPicgo mounted")}return ne.instance}async init(){if(this.isSiyuanOrSiyuanNewWin){const e=this.initSyPicgo(),t=W.siyuanWindow();t.SyPicgo=e,this.syPicgo=e}}initSyPicgo(){var d,g,y;const e=W.siyuanWindow(),t=(y=(g=(d=e==null?void 0:e.siyuan)==null?void 0:d.config)==null?void 0:g.system)==null?void 0:y.workspaceDir,i=`${t}/data/plugins/siyuan-plugin-picgo/libs`,o=e.require(`${i}/sy-picgo-core/syPicgo.js`).default,a=`${t}/data/storage/syp/picgo`+"/picgo.cfg.json",l=o.getCrossPlatformAppDataFolder();return console.log("appFolder=>",l),o.initPicgo(a)}};$(ne,"instance"),$(ne,"logger",q("app-instance"));let Pe=ne;const Yn={useBundledPicgo:!0,extPicgoApiUrl:"http://127.0.0.1:36677"},pt=()=>{const n="siyuan-cfg";return{getSiyuanSetting:()=>{let t="http://127.0.0.1:6806",i="",o="https://api.terwer.space/api/middleware";const s=new ct(t,i);return s.middlewareUrl=o,Lt(n,s,{serializer:Xe.object})}}},Ue=()=>{const n=q("use-siyuan-api"),{getSiyuanSetting:e}=pt(),t=e(),i=t.value.apiUrl,o=t.value.password,s=new ct(i,o);s.cookie=t.value.cookie;const a=new vn(s),l=new Cn(s),{isInChromeExtension:d}=ee(),g=()=>{const u={}.VITE_DEFAULT_TYPE??"siyuan",P=u==="siyuan";return n.info("defaultType=>",u),n.info("storeViaSiyuanApi=>",String(P)),P};return{blogApi:a,kernelApi:l,siyuanConfig:s,isStorageViaSiyuanApi:g,isUseSiyuanProxy:()=>d()?!1:g()}};class Qn{constructor(e){$(this,"logger");$(this,"storageViaSiyuanApi",!0);$(this,"kernelApi");$(this,"key");this.logger=q("common-storage");const{kernelApi:t}=Ue();this.kernelApi=t,this.key=e}async getItem(e){this.logger.info(`Retrieving value for '${e}' from CommonStorage.`);let t;if(this.storageViaSiyuanApi)try{t=await this.kernelApi.getFile(e,"text")??""}catch(i){this.logger.error(`Failed to get value for key '${e}' from SiYuan Api LocalStorageAdaptor. Error:`,i)}else try{t=W.siyuanWindow().localStorage.getItem(e)??""}catch(i){this.logger.error(`Failed to get value for key '${e}' from Browser LocalStorageAdaptor. Error:`,i)}return be.isEmptyString(t)&&(t="{}"),t}async removeItem(e){this.logger.info(`Removing value for ${e} from CommonStorage.`)}async setItem(e,t){this.storageViaSiyuanApi?(await this.kernelApi.saveTextData(e,t),this.logger.debug(`Use SiYuan Api LocalStorageAdaptor to setItem - Key '${e}'`)):(W.siyuanWindow().localStorage.setItem(e,t),this.logger.debug(`Use Browser LocalStorageAdaptor to setItem - Key '${e}'`))}}const Xn=(n,e)=>{const t=q("common-storage-async"),i=new Qn(n),o=$t(e),s=Zn(o);t.debug(`It is detected that the serialization type is ${s}`);const a=Xe[s];return{commonStore:{async get(){t.debug("Fetching data from common storage...");const d=await i.getItem(i.key)??"{}";let g=await a.read(d)??{};return nt.isEmptyObject(g)&&(t.info("Initial data not found in common storage. Setting initial value..."),await i.setItem(i.key,a.write(e)),t.debug("Initial value set:",e),g=e),g},async set(d){await i.setItem(i.key,a.write(d))}}}};function Zn(n){return n==null?"any":n instanceof Set?"set":n instanceof Map?"map":n instanceof Date?"date":typeof n=="boolean"?"boolean":typeof n=="string"?"string":typeof n=="object"?"object":Number.isNaN(n)?"any":"number"}const Le=at("external-picgo-config",()=>{const n=q("use-external-picgo-setting-store"),e="/data/storage/syp/picgo/external-picgo-cfg.json",t=Yn,{commonStore:i}=Xn(e,t),o=j(null),s=Ze(async()=>{const d=await i.get();return n.debug("get data from setting=>",d),o.value=d,d});return{getExternalPicgoSetting:async()=>{if(o.value===null){n.info("Setting not initialized. Initializing now...");const d=s.value;return n.info("Loaded setting from remote api"),d??{}}return n.info("Loaded setting from cache."),o.value??{}},updateExternalPicgoSetting:async d=>{n.debug("update setting=>",d),await i.set(d),o.value={...o.value,...d}}}});class ei{constructor(){$(this,"logger");$(this,"requestUrl","http://127.0.0.1:36677");$(this,"endpointUrl","/upload");this.logger=q("picgo-upload-api")}async upload(e){const{getExternalPicgoSetting:t}=Le(),i=await t();this.requestUrl=i.extPicgoApiUrl??"http://127.0.0.1:36677";let o=JSON.stringify([]);const s={method:"POST"};let a;e&&(a={list:e}),nt.isEmptyObject(a)||Object.assign(s,{body:JSON.stringify(a)}),Object.assign(s,{headers:{"Content-Type":"application/json","User-Agent":"Terwer/0.1.0"}});const l=`${this.requestUrl}${this.endpointUrl}`;this.logger.debug("调用HTTP请求上传图片到PicGO，apiUrl=>",l),this.logger.debug("调用HTTP请求上传图片到PicGO，fetchOps=>",s);const g=await(await fetch(l,s)).json();if(this.logger.debug("调用HTTP请求上传图片到PicGO，resJson=>",g),g.success){const y=[];g.result&&g.result.length>0&&g.result.forEach(u=>{const P={fileName:u.substring(u.lastIndexOf("/")+1),imgUrl:u};y.push(P)}),o=JSON.stringify(y)}else throw new Error("调用HTTP上传到PicGO失败，请检查配置=>"+g.message);return Promise.resolve(o)}}class ut{constructor(){$(this,"logger",q("bundled-picgo-api"));$(this,"picGoUploadApi",new ei)}async uploadByPicGO(e){const t=await Pe.getInstance(),{isInSiyuanOrSiyuanNewWin:i}=ee(),o=i(),{getExternalPicgoSetting:s}=Le(),a=await s();this.logger.debug("extPicgoCfg=>",{extPicgoCfg:a});const l=t.syPicgo;return this.logger.debug("appInstance=>",t),this.logger.debug("appInstance.picgo=>",t.picgo),this.logger.debug("input=>",e),e?o&&a.useBundledPicgo?l.upload(e):this.picGoUploadApi.upload(e):o&&a.useBundledPicgo?l.uploadFormClipboard():this.picGoUploadApi.upload()}}class dt{constructor(e){$(this,"logger",q("picgo-post-api"));$(this,"imageParser");$(this,"siyuanApi");$(this,"siyuanConfig");$(this,"isSiyuanOrSiyuanNewWin");$(this,"picgoApi");this.imageParser=new rt,this.picgoApi=new ut;const{isInSiyuanOrSiyuanNewWin:t}=ee();this.isSiyuanOrSiyuanNewWin=t();const{siyuanConfig:i,kernelApi:o}=Ue();this.siyuanConfig=i,this.siyuanApi=e??o}async doConvertImagesToImagesItemArray(e,t,i){const o=[];for(let s=0;s<t.length;s++){const a=t[s],l=a.url;let d=a.url,g={};if(this.logger.debug("attrs=>",e),be.isEmptyString(e[pe.PICGO_FILE_MAP_KEY])||(g=_e.safeParse(e[pe.PICGO_FILE_MAP_KEY],{}),this.logger.debug("fileMap=>",g)),a.isLocal){let u=i??this.siyuanConfig.apiUrl??"";d=be.pathJoin(u,"/"+d)}const y=new ue(l,d,a.isLocal,a.alt,a.title);if(g[y.hash]){const u=g[y.hash];this.logger.debug("newImageItem=>",u),u.isLocal||(y.isLocal=!1,y.url=u.url)}y.url=decodeURIComponent(y.url),this.logger.debug("imageItem=>",y),o.push(y)}return this.logger.debug("ret=>",o),o}async uploadPostImagesToBed(e,t,i){const o=new Jn,s=this.imageParser.parseLocalImagesToArray(i),a=[...new Set([...s])];if(this.logger.debug("uniqueLocalImages=>",a),a.length===0)return o.flag=!1,o.hasImages=!1,o.mdContent=i,o.errmsg="文章中没有图片",o;try{o.hasImages=!0;const l=await this.doConvertImagesToImagesItemArray(t,a),d={};let g=!1;for(let y=0;y<l.length;y++){const u=l[y];if(u.originUrl.includes("assets")&&(d[u.hash]=u),!u.isLocal){this.logger.debug("已经上传过图床，请勿重复上传=>",u.originUrl);continue}g=!0;let P,w,r;try{await this.uploadSingleImageToBed(e,t,u),P=await this.siyuanApi.getBlockAttrs(e),w=!1,r=_e.safeParse(P[pe.PICGO_FILE_MAP_KEY],{})[u.hash]}catch(_){P=t,w=!0,r=u,this.logger.warn("单个图片上传异常",{pageId:e,attrs:t,imageItem:u}),this.logger.warn("单个图片上传失败，错误信息如下",_)}d[u.hash]=new ue(r.originUrl,r.url,w,r.alt,r.title)}g||this.logger.warn("未发现本地图片，不上传！若之前上传过，将做链接替换"),this.logger.debug("准备替换正文图片，replaceMap=>",JSON.stringify(d)),this.logger.debug("开始替换正文，原文=>",JSON.stringify({mdContent:i})),o.mdContent=this.imageParser.replaceImagesWithImageItemArray(i,d),this.logger.debug("图片链接替换完成，新正文=>",JSON.stringify({newmdContent:o.mdContent})),o.flag=!0,this.logger.debug("正文替换完成，最终结果=>",o)}catch(l){o.flag=!1,o.errmsg=l,this.logger.error("文章图片上传失败=>",l)}return o}async uploadSingleImageToBed(e,t,i,o){const s=t[pe.PICGO_FILE_MAP_KEY]??"{}",a=_e.safeParse(s,{});this.logger.warn("fileMap=>",a);const l=[];if(!o&&!i.isLocal){this.logger.warn("非本地图片，忽略=>",i.url);return}let d;if(this.isSiyuanOrSiyuanNewWin){const P=W.siyuanWindow();d=`${P.siyuan.config.system.dataDir}/assets/${i.name}`,this.logger.info(`Will upload picture from ${d}, imageItem =>`,i),P.require("fs").existsSync(d)||(d=i.url)}else d=i.url;this.logger.warn("isSiyuanOrSiyuanNewWin=>"+this.isSiyuanOrSiyuanNewWin+", imageFullPath=>",d),l.push(d);const g=await this.picgoApi.uploadByPicGO(l);this.logger.warn("图片上传完成，imageJson=>",g);const y=_e.safeParse(g,[]);if(y&&y.length>0){const P=y[0];if(!(P!=null&&P.imgUrl)||be.isEmptyString(P.imgUrl))throw new Error("图片上传失败，可能原因：PicGO配置错误或者该平台不支持图片覆盖，请检查配置或者尝试上传新图片。请打开picgo.log查看更多信息");const w=new ue(i.originUrl,P.imgUrl,!1,i.alt,i.title);a[w.hash]=w}else throw new Error("图片上传失败，可能原因：PicGO配置错误，请检查配置。请打开picgo.log查看更多信息");this.logger.warn("newFileMap=>",a);const u=JSON.stringify(a);await this.siyuanApi.setBlockAttrs(e,{[pe.PICGO_FILE_MAP_KEY]:u})}}const ti=(n,e)=>{const t=q("picgo-common"),{kernelApi:i}=Ue(),o=i,s=new dt,a=new rt,d=e.picgoCommonMethods.getPicgoCommonData(),g=async()=>{const u=n.pageId;console.log("pageId=>",u);const P=await o.getImageBlocksByID(u);if(t.debug("查询文章中的图片块=>",P),!P||P.length===0)return;let w=[];P.forEach(b=>{const B=a.parseImagesToArray(b.markdown);w=[...new Set([...w,...B])]}),t.debug("解析出来的所有的图片地址=>",w);const r=await o.getBlockAttrs(u),_=await s.doConvertImagesToImagesItemArray(r,w);for(let b=0;b<_.length;b++){const B=_[b];d.fileList.files.push(B)}},y={initPage:async()=>{await g()}};return ve(()=>n.pageId,async()=>{await g(),t.debug("Picgo初始化")}),Ce(async()=>{await g()}),{picgoInitMethods:y}},ni=(n,e,t)=>{const i=q("picgo-upload"),{t:o}=Q(),s=Se(),{getExternalPicgoSetting:a,updateExternalPicgoSetting:l}=Le(),d=new ut,g=ie({extPicgoCfg:{}}),u=e.picgoCommonMethods.getPicgoCommonData(),P=t.refSelectedFiles,w=_=>{let b;typeof _=="string"?(i.warn("doAfterUpload返回的是字符串，需要解析"),b=JSON.parse(_)):b=_,u.loggerMsg=JSON.stringify(_),i.debug("doAfterUpload,imgInfos=>",_),b&&b.length>0&&b.forEach(B=>{const N=new ue(B.imgUrl,B.imgUrl,!1);u.loggerMsg+=`
newItem=>`+JSON.stringify(N),u.fileList.files.push(N)}),A.success(o("main.opt.success"))},r={handlePicgoSetting:async()=>{u.isSiyuanOrSiyuanNewWin&&g.extPicgoCfg.useBundledPicgo?await s.push({path:"/setting",query:{showBack:"true"}}):await s.push({path:"/setting/external",query:{showBack:"true"}})},bindFileControl:()=>{P.value.click()},doUploadPicSelected:async _=>{u.isUploadLoading=!0;try{const b=_.target.files;if(i.debug("onRequest fileList=>",b),!b||b.length===0){A.error("请选择图片"),u.loggerMsg=o("main.opt.failure")+"=>请选择图片",u.isUploadLoading=!1;return}if(!u.isSiyuanOrSiyuanNewWin){const D="由于浏览器的安全限制，无法获取本地文件的完整路径，因此非electron环境只能通过剪贴板上传";A.error(D),u.loggerMsg=o("main.opt.failure")+"=>"+D,u.isUploadLoading=!1;return}const B=[];for(let D=0;D<b.length;D++)b.item(D).path?(B.push(b.item(D).path),i.debug("路径不为空")):i.debug("路径为空，忽略");const N=await d.uploadByPicGO(B);w(N),u.isUploadLoading=!1}catch(b){b.toString().indexOf("cancel")<=-1&&(A({type:"error",message:o("main.opt.failure")+"=>"+b}),i.error(o("main.opt.failure")+"=>"+b)),u.loggerMsg=o("main.opt.failure")+"=>"+b,u.isUploadLoading=!1}},doUploadPicFromClipboard:async()=>{u.isUploadLoading=!0;try{const _=await d.uploadByPicGO();w(_),u.isUploadLoading=!1}catch(_){_.toString().indexOf("cancel")<=-1&&(A({type:"error",message:o("main.opt.failure")+"=>"+_}),i.error(o("main.opt.failure")+"=>",_)),u.loggerMsg=o("main.opt.failure")+"=>"+_,u.isUploadLoading=!1}},onPicgoTypeChange:async _=>{if(u.isSiyuanOrSiyuanNewWin)g.extPicgoCfg.useBundledPicgo=_,await l(g.extPicgoCfg);else{g.extPicgoCfg.useBundledPicgo=!1,await ke.alert(o("picgo.pic.setting.no.tip"),o("main.opt.tip"),{confirmButtonText:o("main.opt.ok")});return}}};return Ce(async()=>{u.isSiyuanOrSiyuanNewWin?(g.extPicgoCfg=await a(),i.debug("extPicgoCfg =>",g.extPicgoCfg)):g.extPicgoCfg.useBundledPicgo=!1}),{picgoUploadData:g,picgoUploadMethods:r}},ii=n=>{if(navigator&&navigator.clipboard)navigator.clipboard.writeText(n).then(function(){A.success("复制成功")},function(e){A.error("复制失败=>"+e)});else try{const e=document.createElement("input");e.style.position="fixed",e.style.opacity="0",e.value=n,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),A.success("复制成功")}catch(e){A.error("复制失败=>"+e)}},Be=n=>{if(Array.isArray(n))return n.map(t=>Je(t)?c(t):Ke(t)?de(t):Be(t));if(typeof n=="object"){const e={};return Object.keys(n).forEach(t=>{const i=n[t];Je(i)?e[t]=c(i):Ke(i)?e[t]=de(i):e[t]=Be(i)}),e}return n},ft=n=>{const e={};return Object.keys(n).forEach(t=>{e[t]=typeof n[t]=="string"?n[t].trim():n[t]}),e},oi=(n,e)=>{const t=q("picgo-manage"),{t:i}=Q(),{kernelApi:o}=Ue(),s=o,a=new dt,l=ie({dialogImageUrl:"",dialogPreviewVisible:!1}),g=e.picgoCommonMethods.getPicgoCommonData(),y={handleUploadAllImagesToBed:async()=>{if(g.isUploadLoading=!0,!g.isSiyuanOrSiyuanNewWin){const u="由于浏览器的安全限制，无法获取本地文件的完整路径，因此非electron环境只能通过剪贴板上传";A.error(u),g.loggerMsg=i("main.opt.failure")+"=>"+u,g.isUploadLoading=!1;return}try{let u=!1;const P=g.fileList.files;for(let w=0;w<P.length;w++){const r=P[w];if(!r.isLocal){t.debug("已经上传过图床，请勿重复上传=>",r.originUrl);continue}u=!0,await y.doUploadImagesToBed(r)}g.isUploadLoading=!1,u?(A.success("图片已经全部上传至图床，即将刷新页面"),oe.reloadPage()):A.warning("未发现本地图片，不上传")}catch(u){g.isUploadLoading=!1,A({type:"error",message:i("main.opt.failure")+"=>"+u}),t.error(i("main.opt.failure")+"=>"+u)}},handleUploadCurrentImageToBed:async u=>{if(g.isUploadLoading=!0,!g.isSiyuanOrSiyuanNewWin){const P="由于浏览器的安全限制，无法获取本地文件的完整路径，因此非electron环境只能通过剪贴板上传";A.error(P),g.loggerMsg=i("main.opt.failure")+"=>"+P,g.isUploadLoading=!1;return}if(!u.isLocal)ke.confirm("已经是远程图片，是否仍然覆盖上传？",i("main.opt.warning"),{confirmButtonText:i("main.opt.ok"),cancelButtonText:i("main.opt.cancel"),type:"warning"}).then(async()=>{try{await y.doUploadImagesToBed(u,!0),g.isUploadLoading=!1,A.success("图片已经成功上传至图床，即将刷新页面"),oe.reloadPage()}catch(P){g.isUploadLoading=!1,A({type:"error",message:i("main.opt.failure")+"=>"+P}),t.error(i("main.opt.failure")+"=>"+P)}}).catch(P=>{g.isUploadLoading=!1,P.toString().indexOf("cancel")<=-1&&(A({type:"error",message:i("main.opt.failure")+"，图片上传异常=>"+P}),t.error(i("main.opt.failure")+"=>"+P))});else{try{await y.doUploadImagesToBed(u),g.isUploadLoading=!1,A.success("图片已经成功上传至图床，即将刷新页面"),oe.reloadPage()}catch(P){g.isUploadLoading=!1,A({type:"error",message:i("main.opt.failure")+"=>"+P}),t.error(i("main.opt.failure")+"=>"+P)}g.isUploadLoading=!1}},doUploadImagesToBed:async(u,P)=>{const w=n.pageId,r=await s.getBlockAttrs(w);await a.uploadSingleImageToBed(w,r,u,P)},onImageUrlCopy:u=>{if(oe.isInBrowser){const P=`![](${u})`;ii(P)}},handlePictureCardPreview:u=>{l.dialogImageUrl=u??"",l.dialogPreviewVisible=!0}};return{picgoManageData:l,picgoManageMethods:y}},si=n=>(We("data-v-8ae831f9"),n=n(),De(),n),ai={class:"picgo-body"},ci={class:"upload-status"},li={class:"picgo-opt-btn"},gi={class:"box-item switch-item"},ri={class:"file-list"},pi=["src","alt"],ui=["src"],di={key:0,class:"log-msg"},fi=si(()=>f("div",{class:"el-alert el-alert--warning is-light",role:"alert"},[f("div",{class:"el-alert__content"},[f("div",{class:"el-alert__title"},[f("div",null,"使用须知："),f("div",null,"1、此处上传的图片不会自动插入文档中，请手动点击按钮复制链接，然后 Ctrl+V 粘贴到文档中。"),f("div",null," 2、对于文档当中原本已经存在的本地图片，点击上传之后不会直接替换原始图片，只会存储本地图片与图床图片的映射信息，需要在发布文章时手动勾选【使用图床】才会进行临时链接替换，请知悉。 这样做是为了不破坏其他地方对文档图片的处理。当然，您也可以手动复制图床链接，然后删除原图片，替换为图床图片。 "),f("div",null,"3、该图片列表仅展示此文档包含的图片。")])])],-1)),mi=z({__name:"PicGoIndex",props:{pageId:{type:String,default:oe.getQueryParam("pageId")}},setup(n){const e=n,t=q("picgo-index-page"),i=j(),{t:o}=Q(),{picgoCommonData:s,picgoCommonMethods:a}=Hn(),{picgoInitMethods:l}=ti(e,{picgoCommonMethods:a}),{picgoUploadData:d,picgoUploadMethods:g}=ni(e,{picgoCommonMethods:a},{refSelectedFiles:i}),{picgoManageData:y,picgoManageMethods:u}=oi(e,{picgoCommonMethods:a,picgoInitMethods:l});return t.info("This is picgo index page"),(P,w)=>{const r=me,_=se,b=we("font-awesome-icon"),B=Fe,N=gn,D=ln,J=re;return h(),x("div",ai,[p(r,{title:"当前PicGO为 "+(c(d).extPicgoCfg.useBundledPicgo?"内置PicGO":"外部PicGO")+" ，您可以在下面选择使用内置PicGO还是外部PicGO",type:"warning",closable:!1},null,8,["title"]),f("div",ci,[p(_,{text:"",loading:c(s).isUploadLoading},{default:m(()=>[E(k(c(o)("picgo.upload.status")),1)]),_:1},8,["loading"])]),f("blockquote",li,[f("input",{ref_key:"refSelectedFiles",ref:i,type:"file",accept:"image/png, image/gif, image/jpeg",multiple:"",onChange:w[0]||(w[0]=(...T)=>c(g).doUploadPicSelected&&c(g).doUploadPicSelected(...T))},null,544),c(s).isSiyuanOrSiyuanNewWin?(h(),R(_,{key:0,type:"warning",onClick:c(g).bindFileControl},{default:m(()=>[p(b,{icon:"fa-solid fa-file-import"}),E("  "+k(c(o)("picgo.upload.select.pic")),1)]),_:1},8,["onClick"])):Y("",!0),p(_,{type:"primary",onClick:c(g).doUploadPicFromClipboard},{default:m(()=>[p(b,{icon:"fa-solid fa-paste"}),E("  "+k(c(o)("picgo.upload.clipboard")),1)]),_:1},8,["onClick"]),c(s).isSiyuanOrSiyuanNewWin?(h(),R(_,{key:1,type:"success",onClick:c(u).handleUploadAllImagesToBed},{default:m(()=>[p(b,{icon:"fa-solid fa-upload"}),E("  "+k(c(o)("picgo.upload.onclick")),1)]),_:1},8,["onClick"])):Y("",!0),Y("",!0),p(_,{type:"info",onClick:c(g).handlePicgoSetting},{default:m(()=>[p(b,{icon:"fa-solid fa-gear"}),E("  "+k(c(d).extPicgoCfg.useBundledPicgo?c(o)("picgo.pic.setting"):c(o)("picgo.type.external.title")),1)]),_:1},8,["onClick"]),f("span",gi,[p(B,{modelValue:c(d).extPicgoCfg.useBundledPicgo,"onUpdate:modelValue":w[1]||(w[1]=T=>c(d).extPicgoCfg.useBundledPicgo=T),class:"picgo-type-switch","inline-prompt":"",size:"large",onChange:c(g).onPicgoTypeChange},null,8,["modelValue","onChange"]),E(" 切换PicGO类型 ")])]),f("ul",ri,[(h(!0),x(Z,null,ce(c(s).fileList.files,T=>(h(),x("li",{key:T.name,class:"file-list-item"},[f("div",null,[f("img",{src:T.url,alt:T.name},null,8,pi)]),f("div",null,[c(s).isSiyuanOrSiyuanNewWin?(h(),R(_,{key:0,class:"file-list-action",onClick:v=>c(u).handleUploadCurrentImageToBed(T)},{default:m(()=>[p(b,{icon:T.isLocal?"fa-solid fa-upload":"fa-solid fa-arrow-rotate-right"},null,8,["icon"]),E("  "+k(T.isLocal?c(o)("picgo.download.local.to.bed"):"重新上传"),1)]),_:2},1032,["onClick"])):Y("",!0),Y("",!0),p(N,{placement:"bottom",title:T.alt?T.alt:c(o)("setting.picgo.index.copy.link"),width:c(s).popWidth,trigger:"hover",content:T.url},{reference:m(()=>[p(_,{class:"file-list-action",onClick:v=>c(u).onImageUrlCopy(T.url)},{default:m(()=>[p(b,{icon:"fa-solid fa-file-lines"}),E("  "+k(c(o)("setting.picgo.index.copy.link")),1)]),_:2},1032,["onClick"])]),_:2},1032,["title","width","content"]),p(_,{class:"file-list-action",onClick:v=>c(u).handlePictureCardPreview(T.url)},{default:m(()=>[p(b,{icon:"fa-solid fa-magnifying-glass"}),E("  "+k(c(o)("picgo.pic.preview")),1)]),_:2},1032,["onClick"])])]))),128))]),p(D,{modelValue:c(y).dialogPreviewVisible,"onUpdate:modelValue":w[2]||(w[2]=T=>c(y).dialogPreviewVisible=T),title:c(o)("picgo.pic.preview")+" - "+c(y).dialogImageUrl},{default:m(()=>[f("img",{"w-full":"",src:c(y).dialogImageUrl,alt:"Preview Image",class:"img-big-preview"},null,8,ui)]),_:1},8,["modelValue","title"]),c(s).showDebugMsg?(h(),x("div",di,[p(J,{modelValue:c(s).loggerMsg,"onUpdate:modelValue":w[3]||(w[3]=T=>c(s).loggerMsg=T),type:"textarea",autosize:{minRows:5,maxRows:10}},null,8,["modelValue"])])):Y("",!0),fi])}}});const _i=te(mi,[["__scopeId","data-v-8ae831f9"]]),hi=()=>kn(),yi={newUuid:hi},bi=(n,e)=>{const t=new Blob([n],{type:"application/json"}),i=document.createElement("a");i.download=e??"data.json",i.href=URL.createObjectURL(t),document.body.appendChild(i),i.click()},Pi=async()=>await In({description:"JSON files",mimeTypes:["application/json"],extensions:[".json"],multiple:!0}),wi=async n=>{const e=await Pi(),t=new FileReader;t.addEventListener("load",()=>{const i=JSON.parse(t.result);console.log("准备导入配置，读取到的配置数据为=>",i),n(i)}),t.readAsText(e[0])};var X=(n=>(n.PicgoPageMenuType_Uninstall="uninstall",n.PicgoPageMenuType_Disable="disable",n.PicgoPageMenuType_Enable="enable",n.PicgoPageMenuType_Update="update",n.PicgoPageMenuType_ConfigThing="configThing",n.PicgoPageMenuType_Transfer="transformer",n.PicgoPageMenuType_Plugin="plugin",n))(X||{});const vi=()=>{const e=W.siyuanWindow().SyPicgo.getPicgoObj(),t=e.helper.uploader.getIdList(),i=e.getConfig("picBed.list")||[];return t.map(s=>{const a=i.find(l=>l.type===s);return{type:s,name:e.helper.uploader.get(s).name||s,visible:a?a.visible:!0}}).sort(s=>s.type==="github"?-1:0)},Ae=(n=void 0)=>W.siyuanWindow().SyPicgo.getPicgoObj().getConfig(n),fe=(n,e=void 0)=>{const i=W.siyuanWindow().SyPicgo.getPicgoObj();let o;typeof n=="string"?o={[n]:e}:o=Be(n),i.saveConfig(o),console.log("savePicgoConfig finished.")},Ci=n=>{for(const e in n)typeof n[e].default=="function"&&(n[e].default=n[e].default()),typeof n[e].choices=="function"&&(n[e].choices=n[e].choices());return n},mt=n=>Object.assign({_configName:"Default"},ft(n),{_id:yi.newUuid(),_createdAt:Date.now(),_updatedAt:Date.now()}),Si=n=>{var o,s;const t=W.siyuanWindow().SyPicgo.getPicgoObj(),i=((o=t.helper.uploader.get(n))==null?void 0:o.name)||n;if((s=t.helper.uploader.get(n))!=null&&s.config){const a=t.helper.uploader.get(n).config(t);return{config:Ci(a),name:i}}else return{config:[],name:i}},ki=n=>{const t=W.siyuanWindow().SyPicgo.getPicgoObj(),i=t.getConfig(`picBed.${n}`)??{};i._id||Object.assign(i,mt(i));const o=[i];return t.saveConfig({[`uploader.${n}`]:{configList:o,defaultId:i._id},[`picBed.${n}`]:i}),{configList:o,defaultId:i._id}},$e=n=>{const t=W.siyuanWindow().SyPicgo.getPicgoObj();if(!n)return{configList:[],defaultId:""};const i=t.getConfig(`uploader.${n}`)??{};let o=i.configList,s=i.defaultId||"";if(!o){const l=ki(n);o=l.configList,s=l.defaultId}return{configList:o,defaultId:s}},_t=(n,e,t)=>{const o=W.siyuanWindow().SyPicgo.getPicgoObj();n&&(t&&o.saveConfig({[`uploader.${n}.defaultId`]:t}),e&&o.saveConfig({[`picBed.${n}`]:e}),o.saveConfig({"picBed.current":n,"picBed.uploader":n}))},Ii=(n,e)=>{const i=W.siyuanWindow().SyPicgo.getPicgoObj(),{configList:o}=$e(n),s=o.find(a=>a._id===e);return s&&i.saveConfig({[`uploader.${n}.defaultId`]:e,[`picBed.${n}`]:s}),s},xi=(n,e,t)=>{const o=W.siyuanWindow().SyPicgo.getPicgoObj(),{configList:s,defaultId:a}=$e(n),l=s.find(y=>y._id===e);let d,g=a;l?d=Object.assign(l,ft(t),{_updatedAt:Date.now()}):(d=mt(t),g=d._id,s.push(d)),o.saveConfig({[`uploader.${n}.configList`]:s,[`uploader.${n}.defaultId`]:g,[`picBed.${n}`]:d})},Oi=(n,e)=>{const i=W.siyuanWindow().SyPicgo.getPicgoObj(),{configList:o,defaultId:s}=$e(n);if(o.length<=1)return;let a=s;const l=o.filter(d=>d._id!==e);return e===s&&(a=l[0]._id,_t(n,l[0],l[0]._id)),i.saveConfig({[`uploader.${n}.configList`]:l}),{configList:l,defaultId:a}},ht=()=>{var t;const n=W.siyuanWindow(),e=(t=n==null?void 0:n.SyPicgo)==null?void 0:t.getPicgoObj();return e?e.baseDir:"[PicGO未挂载]"},qe=()=>{var t;const n=W.siyuanWindow(),e=(t=n==null?void 0:n.SyPicgo)==null?void 0:t.getPicgoObj();return e?e.configPath:"[PicGO未挂载]"},Ui=n=>{const e=W.siyuanWindow(),t=e==null?void 0:e.SyPicgo,i=t==null?void 0:t.getPicgoObj();return i?t.combinePath(i.baseDir,n):"[PicGO未挂载]"},Li=()=>{const n=W.siyuanWindow(),e=n==null?void 0:n.SyPicgo,t=e==null?void 0:e.getPicgoObj();return t?t.VERSION:"1.5.0"},Me=(n,e)=>{n==="uploader"&&Ae("picBed.current")===e&&fe({"picBed.current":"github","picBed.uploader":"github"}),n==="transformer"&&Ae("picBed.transformer")===e&&fe({"picBed.transformer":"path"})},ge=(n,e={})=>{const t=W.siyuanWindow();(t==null?void 0:t.SyPicgo).ipcMethods.handleEvent(n,e)},$i=(n,e={})=>{const t=W.siyuanWindow();(t==null?void 0:t.SyPicgo).ipcMethods.registerEvent(n,e)},Ei=n=>{const e=W.siyuanWindow();(e==null?void 0:e.SyPicgo).ipcMethods.removeEvent(n)},Ni=(n,e)=>{const t=W.siyuanWindow(),i=[],s={label:e(X.PicgoPageMenuType_Enable)["setting.picgo.plugin.enable"],enabled:!n.enabled,click(){fe({[`picgoPlugins.${n.fullName}`]:!0}),oe.reloadPageWithMessageCallback("插件已启用，即将刷新页面...")}},l={label:e(X.PicgoPageMenuType_Disable)["setting.picgo.plugin.disable"],enabled:n.enabled,click(){fe({[`picgoPlugins.${n.fullName}`]:!1}),n.config.transformer.name&&Me("transformer",n.config.transformer.name),n.config.uploader.name&&Me("uploader",n.config.uploader.name),oe.reloadPageWithMessageCallback("插件已禁用，即将刷新页面...")}},g={label:e(X.PicgoPageMenuType_Uninstall)["setting.picgo.plugin.uninstall"],click(){ge("picgoHandlePluginIng",n.fullName),ge("uninstallPlugin",n.fullName)}};e(X.PicgoPageMenuType_Update)["setting.picgo.plugin.update"],i.push(s),i.push(l),i.push(g),i.push({label:" -------- ",click(){}});const u=e(X.PicgoPageMenuType_Plugin);for(const b in n.config)if(b!=="uploader"&&n.config[b].config.length>0){const B={label:`${u["setting.picgo.plugin.config.setting"]} - ${n.config[b].fullName||n.config[b].name}`,click(){const N=b,D=n.config[b].fullName||n.config[b].name,J=n.config[b].config;ge("picgoConfigPlugin",{currentType:N,configName:D,config:J})}};i.push(B)}const{Menu:P,getCurrentWindow:w}=t.require("@electron/remote"),r=w();P.buildFromTemplate(i).popup({elecWin:r})},Ti=()=>{const n=W.siyuanWindow(),e=n==null?void 0:n.SyPicgo,t=e==null?void 0:e.getPicgoObj();if(!t)throw new Error("[PicGO未挂载]");const i=qe(),o=e.readFileAsJson(i),s="sy-picgo-cfg-v"+t.GUI_VERSION+".json";bi(o,s)},Bi=()=>{const n=W.siyuanWindow(),e=ht();(n==null?void 0:n.SyPicgo).rmFolder(e)},Ai=async()=>{const n=W.siyuanWindow(),e=n==null?void 0:n.SyPicgo,t=qe();await wi(function(i){i.picgoPlugins={};const o=JSON.stringify(i);e.restoreCfg(o,t),oe.reloadPageWithMessageCallback("导入成功",void 0)})},S={getPicgoConfig:Ae,savePicgoConfig:fe,getPicBedConfig:Si,getPicBeds:vi,getUploaderConfigList:$e,selectUploaderConfig:Ii,changeCurrentUploader:_t,deleteUploaderConfig:Oi,updateUploaderConfig:xi,getPicgoBasedir:ht,getPicgoCfgPath:qe,getPicgoCfgFile:Ui,ipcHandleEvent:ge,ipcRegisterEvent:$i,ipcRemoveEvent:Ei,getPicgoVersion:Li,buildPluginMenu:Ni,handleRestoreState:Me,clearPicgoCfg:Bi,backupPicgoCfg:Ti,importPicgoCfg:Ai},Mi={class:"config-form-box"},Wi={class:"config-form-header"},Di={class:"flex items-center"},Gi=["title"],Vi={class:"config-form"},Ri=z({__name:"ConfigForm",props:{configType:String,config:Object,id:String,configId:String,isNewForm:Boolean},emits:["on-change"],setup(n,{emit:e}){const t=n,i=q("picbed-config-form"),{t:o}=Q(),s=j(),a=j([]),l=ie({});ve(t.config,r=>{i.info("检测到配置文件变化，val=>",r),d(r)},{deep:!0,immediate:!0});function d(r){y(r)}function g(){const r=t.configId;let _;switch(t.configType){case"plugin":{_=S.getPicgoConfig(`${t.configId}`)||{_configName:t.configId};break}case"uploader":{_=(S.getPicgoConfig(`uploader.${t.id}.configList`)||[]).find(B=>B._id===r)||{};break}case"transformer":{_=S.getPicgoConfig(`transformer.${t.configId}`)||{};break}default:_={};break}return console.log("curConfig=>",_),_}function y(r){const _=t.isNewForm?{}:g(),b=t.isNewForm?void 0:t.configId;Object.assign(l,_),i.debug("form属性=>",l),i.debug("configId=>",b);const B=de(r);i.debug("追加form属性rawVal=>",B),B.length>0&&(a.value=xn(B).map(N=>{var J;if(!b)return N;let D=N.default!==void 0?N.default:N.type==="checkbox"?[]:null;if(N.type==="checkbox"){const T=((J=N.choices)==null?void 0:J.filter(v=>v.checked).map(v=>v.value))||[];D=On(D,T)}return _&&_[N.name]!==void 0&&(D=_[N.name]),l[N.name]=D,N})),i.debug("完整form属性=>",l),i.debug("动态配置configList=>",a.value),i.debug("追加form完成.")}async function u(){return new Promise(r=>{var _;(_=s.value)==null||_.validate(b=>{if(b)r(l);else return r(!1),!1})})}const P=()=>{e("on-change")},w=async()=>{const r=await u()||!1;if(console.log("准备保存配置result",r),r!==!1)switch(t.configType){case"plugin":S.savePicgoConfig(`${t.configId}`,r);break;case"uploader":S.updateUploaderConfig(t.id,r==null?void 0:r._id,r);break;case"transformer":S.savePicgoConfig(`transformer.${t.configId}`,r);break}else{A.error(o("main.opt.failure"));return}P()};return(r,_)=>{const b=je,B=re,N=Ie,D=rn,J=pn,T=Fe,v=se,H=xe;return h(),x("div",Mi,[f("div",Wi,[p(b,{icon:c(Ve),title:"返回",onClick:P},{content:m(()=>[f("div",Di,[f("span",{class:"text-large font-600 mr-3",title:l._configName},k(l._configName),9,Gi)])]),_:1},8,["icon"])]),f("div",Vi,[p(H,{ref_key:"$configForm",ref:s,"label-width":"250px",model:l},{default:m(()=>[p(N,{label:c(o)("setting.picgo.config.name"),required:"",prop:"_configName"},{default:m(()=>[p(B,{modelValue:l._configName,"onUpdate:modelValue":_[0]||(_[0]=U=>l._configName=U),placeholder:c(o)("setting.picgo.config.name.placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),(h(!0),x(Z,null,ce(a.value,(U,I)=>(h(),R(N,{key:U.name+I,label:U.alias||U.name,required:U.required,prop:U.name},{default:m(()=>[U.type==="input"||U.type==="password"?(h(),R(B,{key:0,modelValue:l[U.name],"onUpdate:modelValue":C=>l[U.name]=C,type:U.type==="password"?"password":"input",placeholder:U.message||U.name},null,8,["modelValue","onUpdate:modelValue","type","placeholder"])):U.type==="list"&&U.choices?(h(),R(J,{key:1,modelValue:l[U.name],"onUpdate:modelValue":C=>l[U.name]=C,placeholder:U.message||U.name},{default:m(()=>[(h(!0),x(Z,null,ce(U.choices,C=>(h(),R(D,{key:C.name||C.value||C,label:C.name||C.value||C,value:C.value||C},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])):U.type==="checkbox"&&U.choices?(h(),R(J,{key:2,modelValue:l[U.name],"onUpdate:modelValue":C=>l[U.name]=C,placeholder:U.message||U.name,multiple:"","collapse-tags":""},{default:m(()=>[(h(!0),x(Z,null,ce(U.choices,C=>(h(),R(D,{key:C.value||C,label:C.name||C.value||C,value:C.value||C},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])):U.type==="confirm"?(h(),R(T,{key:3,modelValue:l[U.name],"onUpdate:modelValue":C=>l[U.name]=C,"active-text":"yes","inactive-text":"no"},null,8,["modelValue","onUpdate:modelValue"])):Y("",!0)]),_:2},1032,["label","required","prop"]))),128)),p(N,null,{default:m(()=>[p(v,{onClick:w},{default:m(()=>[E(k(c(o)("main.opt.ok")),1)]),_:1})]),_:1})]),_:1},8,["model"])])])}}});const yt=te(Ri,[["__scopeId","data-v-9a3c54ca"]]),Fi={id:"plugin-view"},ji={class:"view-title"},qi={key:0,class:"plugin-list-box"},Hi={class:"plugin-search-box"},zi={class:"plugin-list-tip"},Ji={key:0,class:"cli-only-badge",title:"CLI only"},Ki=["src","onerror"],Yi=["onClick"],Qi=["title"],Xi={class:"plugin-item__info-bar"},Zi={class:"plugin-item__author"},eo={class:"plugin-item__config"},to={key:0,class:"config-button work"},no={key:1,class:"config-button nowork"},io=["onClick"],oo={key:1,class:"config-button ing"},so={key:2,class:"config-button ing"},ao={key:3,class:"config-button ing"},co={key:0,class:"config-button ing"},lo={key:1,class:"plugin-config-form"},go=z({__name:"PicgoPluginSetting",setup(n){const e=q("picgo-plugin-setting"),{t}=Q(),i=j(!1),o=j(""),s=ie({pluginList:[],pluginNameList:[]}),a=j(""),l=j('this.src="/plugins/siyuan-plugin-picgo/libs/sy-picgo-core/picgo-logo.png"'),d=Ze(()=>o.value.match("picgo-plugin-")?o.value:o.value!==""?`picgo-plugin-${o.value}`:o.value);let g;const y=j(!1),u=ie({currentType:"plugin",configName:"",config:{}});ve(d,I=>{I?(i.value=!0,s.pluginList=[],g(I)):w()});function P(){y.value=!1}function w(){S.ipcHandleEvent("getPluginList")}const r=I=>(console.log("checkWork item=>",I),["watermark-elec","s3","minio"].includes(I.name));function _(I){I&&window.open(I)}function b(){window.open("https://github.com/PicGo/Awesome-PicGo")}function B(){S.ipcHandleEvent("importLocalPlugin")}function N(I){I.gui?(I.ing=!0,S.ipcHandleEvent("installPlugin",I.fullName)):ke.confirm(t("setting.picgo.plugin.gui.not.implemented"),t("main.opt.tip"),{confirmButtonText:t("main.opt.ok"),cancelButtonText:t("main.opt.cancel"),type:"warning"}).then(()=>{I.ing=!0,S.ipcHandleEvent("installPlugin",I.fullName)}).catch(()=>{e.warn("Install canceled")})}async function D(I){S.buildPluginMenu(I,J)}function J(I){const C=[];switch(I){case X.PicgoPageMenuType_Uninstall:C["setting.picgo.plugin.uninstall"]=t("setting.picgo.plugin.uninstall");break;case X.PicgoPageMenuType_Enable:C["setting.picgo.plugin.enable"]=t("setting.picgo.plugin.enable");break;case X.PicgoPageMenuType_Disable:C["setting.picgo.plugin.disable"]=t("setting.picgo.plugin.disable");break;case X.PicgoPageMenuType_Update:C["setting.picgo.plugin.update"]=t("setting.picgo.plugin.update");break;case X.PicgoPageMenuType_ConfigThing:break;case X.PicgoPageMenuType_Transfer:C["setting.picgo.plugin.enable"]=t("setting.picgo.plugin.enable"),C["setting.picgo.plugin.disable"]=t("setting.picgo.plugin.disable");break;case X.PicgoPageMenuType_Plugin:C["setting.picgo.plugin.config.setting"]=t("setting.picgo.plugin.config.setting");break}return C}function T(I){const C=`https://registry.npmjs.com/-/v1/search?text=${I}`;e.info("npmjs请求fetchUrl=>",C),fetch(C).then(async O=>{const M=await O.json(),L=(M==null?void 0:M.objects)??[];e.info("npmjs返回的package列表list=>",L),s.pluginList=L.filter(F=>F.package.name.includes("picgo-plugin-")).map(F=>H(F)),i.value=!1}).catch(O=>{console.log(O),i.value=!1})}const v=I=>/^@[^/]+\/picgo-plugin-/.test(I)?I.replace(/^@[^/]+\/picgo-plugin-/,""):I.replace(/picgo-plugin-/,"");function H(I){const C=v(I.package.name);let O=!1;return I.package.keywords&&I.package.keywords.length>0&&I.package.keywords.includes("picgo-gui-plugin")&&(O=!0),{name:C,fullName:I.package.name,author:I.package.author.name,description:I.package.description,logo:`https://cdn.jsdelivr.net/npm/${I.package.name}/logo.png`,config:{},homepage:I.package.links?I.package.links.homepage:"",hasInstall:s.pluginNameList.some(M=>M===I.package.name),version:I.package.version,gui:O,ing:!1}}function U(){o.value=""}return Re(()=>{const I=W.siyuanWindow();a.value=I.process.platform,S.ipcRegisterEvent("pluginList",(C,O)=>{e.info("PicgoPluginSetting接收到pluginList事件,data=>",O);const M=O.rawArgs;if(M.success){const L=M.data;s.pluginList=L,s.pluginNameList=L.map(F=>F.fullName),e.info("插件列表已经成功加载.",L)}else A.error(M.error)}),S.ipcRegisterEvent("installPluginFinished",(C,O)=>{i.value=!1,e.info("PicgoPluginSetting接收到installPluginFinished事件,data=>",O);const M=O.rawArgs.body,L=O.rawArgs.success,F=O.rawArgs.errMsg;s.pluginList.forEach(K=>{K.fullName===M&&(K.ing=!1,K.hasInstall=L)}),L?(S.ipcHandleEvent("getPicBeds"),A.success(t("setting.picgo.plugin.install.success"))):A.error(F)}),S.ipcRegisterEvent("picgoHandlePluginIng",(C,O)=>{const M=O.rawArgs;s.pluginList.forEach(L=>{(L.fullName===M||L.name===M)&&(L.ing=!0)}),i.value=!0}),S.ipcRegisterEvent("uninstallSuccess",(C,O)=>{i.value=!1,e.info("PicgoPluginSetting接收到installPluginFinished事件,data=>",O);const M=O.rawArgs.body,L=O.rawArgs.success,F=O.rawArgs.errMsg;L?(s.pluginList=s.pluginList.filter(K=>(K.fullName===M&&(K.config.transformer.name&&S.handleRestoreState("transformer",K.config.transformer.name),K.config.uploader.name&&S.handleRestoreState("uploader",K.config.uploader.name),S.ipcHandleEvent("getPicBeds")),K.fullName!==M)),s.pluginNameList=s.pluginNameList.filter(K=>K!==M),A.success(t("setting.picgo.plugin.uninstall.success"))):A.error(F),i.value=!1}),S.ipcRegisterEvent("updateSuccess",(C,O)=>{i.value=!1,e.info("PicgoPluginSetting接收到updateSuccess事件,data=>",O);const M=O.rawArgs.body,L=O.rawArgs.success,F=O.rawArgs.errMsg;s.pluginList.forEach(K=>{K.fullName===M&&(K.ing=!1)}),L?A.success(t("setting.picgo.plugin.update.success")):A.error(F),y.value=!1,i.value=!1}),S.ipcRegisterEvent("picgoConfigPlugin",(C,O)=>{i.value=!1,e.info("PicgoPluginSetting接收到picgoConfigPlugin事件,data=>",O);const M=O.rawArgs.currentType,L=O.rawArgs.configName,F=O.rawArgs.config;e.info("_currentType=>",M),e.info("_configName=>",L),e.info("_config=>",F),u.currentType=M,u.configName=L,u.config=F,y.value=!0}),w(),g=Sn.debounce(T,50)}),et(()=>{S.ipcRemoveEvent("pluginList"),S.ipcRemoveEvent("installPluginFinished"),S.ipcRemoveEvent("picgoHandlePluginIng"),S.ipcRemoveEvent("uninstallSuccess"),S.ipcRemoveEvent("updateSuccess"),S.ipcRemoveEvent("picgoConfigPlugin")}),(I,C)=>{const O=we("font-awesome-icon"),M=se,L=it,F=un,K=re,ze=dn,bt=fn,Pt=mn;return h(),x("div",Fi,[f("div",ji,[E(k(c(t)("setting.picgo.plugin"))+" - ",1),p(L,{content:c(t)("setting.picgo.plugin.list"),placement:"right"},{default:m(()=>[p(M,{class:"el-icon-goods",onClick:b},{default:m(()=>[p(O,{icon:"fa-solid fa-cart-shopping"})]),_:1})]),_:1},8,["content"]),p(L,{content:c(t)("setting.picgo.plugin.import.local"),placement:"left"},{default:m(()=>[p(M,{class:"el-icon-download",onClick:B},{default:m(()=>[p(O,{icon:"fa-solid fa-download"})]),_:1})]),_:1},8,["content"])]),y.value?(h(),x("div",lo,[p(yt,{"config-type":u.currentType,id:u.currentType,"config-id":u.configName,config:u.config,"is-new-form":!1,onOnChange:P},null,8,["config-type","id","config-id","config"])])):(h(),x("div",qi,[f("div",Hi,[p(ze,{class:ye(["handle-bar",{"cut-width":s.pluginList.length>6}])},{default:m(()=>[p(K,{modelValue:o.value,"onUpdate:modelValue":C[0]||(C[0]=G=>o.value=G),placeholder:c(t)("setting.picgo.plugin.search.placeholder")},{suffix:m(()=>[p(F,{class:"el-input__icon",style:{cursor:"pointer"},onClick:U},{default:m(()=>[p(O,{icon:"fa-solid fa-xmark"})]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["class"])]),f("div",zi,k("当前共有"+s.pluginList.length+"个插件。"),1),f("div",null,[Et((h(),R(ze,{gutter:10,class:"plugin-list"},{default:m(()=>[(h(!0),x(Z,null,ce(s.pluginList,G=>(h(),R(bt,{key:G.fullName,class:"plugin-item__container",span:12},{default:m(()=>[f("div",{class:ye(["plugin-item",{darwin:a.value==="darwin"}])},[G.gui?Y("",!0):(h(),x("div",Ji,"CLI")),f("img",{class:"plugin-item__logo",src:G.logo,onerror:l.value,alt:"img"},null,8,Ki),f("div",{class:ye(["plugin-item__content",{disabled:!G.enabled}])},[f("div",{class:"plugin-item__name",onClick:Ee=>_(G.homepage)},[E(k(G.name)+" ",1),f("small",null,k(" "+G.version),1)],8,Yi),f("div",{class:"plugin-item__desc",title:G.description},k(G.description),9,Qi),f("div",Xi,[f("span",Zi,k(G.author),1),f("span",eo,[o.value?(h(),x(Z,{key:0},[r(G)?(h(),x("span",to,k(c(t)("setting.picgo.plugin.work")),1)):(h(),x("span",no,k(c(t)("setting.picgo.plugin.nowork")),1)),G.hasInstall?(h(),x("span",ao,k(c(t)("setting.picgo.plugin.installed")),1)):(h(),x(Z,{key:2},[!G.ing&&r(G)?(h(),x("span",{key:0,class:"config-button install",onClick:Ee=>N(G)},k(c(t)("setting.picgo.plugin.install")),9,io)):!G.ing&&!r(G)?(h(),x("span",oo,k(c(t)("setting.picgo.plugin.nouse")),1)):G.ing?(h(),x("span",so,k(c(t)("setting.picgo.plugin.installing")),1)):Y("",!0)],64))],64)):(h(),x(Z,{key:1},[G.ing?(h(),x("span",co,k(c(t)("setting.picgo.plugin.doing.something")),1)):(h(),x(Z,{key:1},[G.enabled?(h(),R(F,{key:0,class:"el-icon-setting",onClick:Ee=>D(G)},{default:m(()=>[p(O,{icon:"fa-solid fa-gear"})]),_:2},1032,["onClick"])):(h(),R(F,{key:1,class:"el-icon-remove-outline",onClick:Ee=>D(G)},{default:m(()=>[p(O,{icon:"fa-solid fa-bell-slash"})]),_:2},1032,["onClick"]))],64))],64))])])],2)],2)]),_:2},1024))),128))]),_:1})),[[Pt,i.value]])])]))])}}});const ro=n=>{const e=W.siyuanWindow(),{shell:t}=e.require("electron");t.openPath(n)},po={openPath:ro},uo={key:0},Ne="https://registry.npmmirror.com",fo=z({__name:"PicgoConfigSetting",setup(n){const e=q("picgo-config-setting"),{t}=Q(),{isInSiyuanOrSiyuanNewWin:i}=ee(),o=i(),s=j([]),a=ie({showPicBedList:[],autoRename:!1,nodePath:"",nodeRegistry:Ne,nodeProxy:""});function l(){const w=S.getPicBeds();s.value=w,a.showPicBedList=s.value.map(r=>r.visible?r.name:null).filter(r=>r)}function d(w){const r=s.value.map(_=>(w.includes(_.name)?_.visible=!0:_.visible=!1,_));S.savePicgoConfig({"picBed.list":r}),e.debug("保存启用的图床",r)}const g=w=>{const r=S.getPicgoCfgFile(w);e.warn("即将打开文件=>",r),po.openPath(r)},y=w=>{S.savePicgoConfig({"settings.autoRename":w})},u=()=>{a.nodePath=a.nodePath.trim(),a.nodeRegistry=a.nodeRegistry.trim(),a.nodeProxy=a.nodeProxy.trim(),a.nodeRegistry=a.nodeRegistry===""?Ne:a.nodeRegistry,S.savePicgoConfig({"settings.nodePath":a.nodePath,"settings.registry":a.nodeRegistry,"settings.proxy":a.nodeProxy===""?void 0:a.nodeProxy}),A.success(t("main.opt.success"))};function P(){const w=S.getPicgoConfig();if(e.debug("PicGO setting initData=>",w),w!==void 0){const r=w.settings||{};a.autoRename=r.autoRename??!0,a.nodePath=r.nodePath??"",a.nodeRegistry=r.registry??Ne,a.nodeProxy=r.nodeProxy??"",S.savePicgoConfig({"settings.autoRename":a.autoRename,"settings.registry":a.nodeRegistry})}}return Re(()=>{S.ipcRegisterEvent("getPicBeds",(w,r)=>{l()}),l(),P()}),et(()=>{S.ipcRemoveEvent("getPicBeds")}),(w,r)=>{const _=se,b=Ie,B=hn,N=yn,D=Fe,J=re,T=xe;return h(),x("div",null,[p(T,{"label-width":"125px"},{default:m(()=>[p(b,{label:c(t)("setting.picgo.picgo.open.config.file")},{default:m(()=>[p(_,{onClick:r[0]||(r[0]=v=>g("picgo.cfg.json"))},{default:m(()=>[E(k(c(t)("setting.picgo.picgo.click.to.open")),1)]),_:1})]),_:1},8,["label"]),p(b,{label:c(t)("setting.picgo.setting.log.file")},{default:m(()=>[p(_,{onClick:r[1]||(r[1]=v=>g("picgo.log"))},{default:m(()=>[E(k(c(t)("setting.picgo.picgo.click.to.open")),1)]),_:1})]),_:1},8,["label"]),p(b,{label:c(t)("setting.picgo.picgo.choose.showed.picbed")},{default:m(()=>[p(N,{modelValue:a.showPicBedList,"onUpdate:modelValue":r[2]||(r[2]=v=>a.showPicBedList=v),onChange:d},{default:m(()=>[(h(!0),x(Z,null,ce(s.value,v=>(h(),R(B,{key:v.name,label:v.name},null,8,["label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),p(b,{label:c(t)("setting.picgo.setting.timestamp.rename")},{default:m(()=>[p(D,{modelValue:a.autoRename,"onUpdate:modelValue":r[3]||(r[3]=v=>a.autoRename=v),"active-text":c(t)("setting.picgo.setting.open"),"inactive-text":c(t)("setting.picgo.setting.close"),onChange:y},null,8,["modelValue","active-text","inactive-text"])]),_:1},8,["label"]),c(o)?(h(),x("div",uo,[p(c(_n)),f("p",null,k(c(t)("setting.picgo.setting.config.tip")),1),p(b,{label:c(t)("setting.picgo.setting.node.path")},{default:m(()=>[p(J,{modelValue:a.nodePath,"onUpdate:modelValue":r[4]||(r[4]=v=>a.nodePath=v),placeholder:c(t)("setting.picgo.setting.node.path.tip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),p(b,{label:c(t)("setting.picgo.setting.node.registry")},{default:m(()=>[p(J,{modelValue:a.nodeRegistry,"onUpdate:modelValue":r[5]||(r[5]=v=>a.nodeRegistry=v),placeholder:c(t)("setting.picgo.setting.node.registry.tip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),p(b,{label:c(t)("setting.picgo.setting.node.proxy")},{default:m(()=>[p(J,{modelValue:a.nodeProxy,"onUpdate:modelValue":r[6]||(r[6]=v=>a.nodeProxy=v),placeholder:c(t)("setting.picgo.setting.node.proxy.tip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),p(b,null,{default:m(()=>[p(_,{onClick:u},{default:m(()=>[E(k(c(t)("main.opt.ok")),1)]),_:1})]),_:1})])):Y("",!0)]),_:1})])}}}),mo=at("picbedStore",()=>{const n=j("github");function e(i){n.value=i,console.log("setDefaultPicBed=>",n.value)}return{defaultPicBed:n,setDefaultPicBed:e}}),_o={class:"picbed-setting"},ho={class:"bed-type-list"},yo={class:"profile-box"},bo={key:0,class:"profile-setting"},Po={class:"profile-card-box"},wo=["onClick"],vo={class:"profile-card-line"},Co={class:"pull-right"},So={class:"profile-date"},ko={class:"profile-action"},Io={key:1,class:"profile-form"},xo=z({__name:"PicbedSetting",props:{isReload:Boolean},setup(n){const e=n,t=q("picbed-setting"),i=ie({showPicBedList:[]}),o=ie({defaultConfigId:"",curConfigList:[],curConfig:{},curConfigId:""}),s=j(""),a=j(""),l=mo(),{t:d}=Q(),g=j(!1),y=j(!1),u=()=>S.getPicgoConfig("picBed.uploader")||S.getPicgoConfig("picBed.current")||"github",P=()=>S.getPicBeds().map(H=>H.visible?H:null).filter(H=>H),w=v=>S.getUploaderConfigList(v),r=v=>{D(),s.value=v.type,T(v.type),t.debug("item=>",v)};function _(v){o.defaultConfigId=v;const H=S.selectUploaderConfig(s.value,v);t.debug("selectItem config=>",H)}function b(){const v=S.getPicBedConfig(s.value);o.curConfig=v.config,o.curConfigId=void 0,g.value=!0,y.value=!0,t.debug("addNewConfig type=>",s.value),t.debug("addNewConfig id=>",o.curConfigId),t.debug("addNewConfig config=>",de(o.curConfig))}function B(v){const H=S.getPicBedConfig(s.value);o.curConfig=H.config,o.curConfigId=v,g.value=!1,y.value=!0,t.debug("editConfig type=>",s.value),t.debug("editConfig id=>",o.curConfigId),t.debug("editConfig config=>",de(o.curConfig))}function N(v){S.deleteUploaderConfig(s.value,v)}function D(){g.value=!1,y.value=!1}function J(v){S.savePicgoConfig({"picBed.current":v,"picBed.uploader":v}),l.setDefaultPicBed(v),a.value=v,t.info("当前存储的图床类型=>",v),A.success(d("main.opt.success"))}const T=(v=void 0)=>{const H=P();v||(v=H.length>0?H[0].type:"github"),s.value=v,i.showPicBedList=H;const U=w(v);o.curConfigList=U.configList,o.defaultConfigId=U.defaultId,a.value=u(),l.setDefaultPicBed(a.value)};return ve(()=>e.isReload,()=>{T(),t.debug("picbed-setting初始化")}),Ce(()=>{T()}),(v,H)=>{const U=me,I=se,C=bn,O=we("font-awesome-icon"),M=it;return h(),x("div",_o,[p(U,{title:c(d)("setting.picgo.picbed.current.selected.tip")+s.value+"，"+c(d)("setting.picgo.picbed.current.tip")+a.value,type:"success",closable:!1},null,8,["title"]),f("div",ho,[p(C,null,{default:m(()=>[(h(!0),x(Z,null,ce(i.showPicBedList,L=>(h(),R(I,{type:s.value===L.type?"primary":"",key:L.name,onClick:F=>r(L)},{default:m(()=>[E(k(L.name),1)]),_:2},1032,["type","onClick"]))),128))]),_:1})]),f("div",yo,[y.value?(h(),x("div",Io,[p(yt,{"config-type":"uploader",id:s.value,config:o.curConfig,"config-id":o.curConfigId,"is-new-form":g.value,onOnChange:D},null,8,["id","config","config-id","is-new-form"])])):(h(),x("div",bo,[f("div",Po,[(h(!0),x(Z,null,ce(o.curConfigList,L=>(h(),x("div",{key:L._id,class:"profile-card-item",onClick:()=>_(L._id)},[p(c(Oe),null,{default:m(()=>[f("div",vo,[f("span",null,k(L._configName),1),f("span",Co,[p(M,{content:c(d)("main.opt.edit"),class:"box-item",effect:"dark",placement:"bottom","popper-class":"publish-menu-tooltip"},{default:m(()=>[p(I,{onClick:Ye(F=>B(L._id),["stop"])},{default:m(()=>[p(O,{icon:"fa-solid fa-pen-to-square"})]),_:2},1032,["onClick"])]),_:2},1032,["content"]),p(M,{content:c(d)("main.opt.delete"),class:"box-item",effect:"dark",placement:"bottom","popper-class":"publish-menu-tooltip"},{default:m(()=>[p(I,{onClick:Ye(F=>N(L._id),["stop"])},{default:m(()=>[p(O,{icon:"fa-solid fa-trash-can"})]),_:2},1032,["onClick"])]),_:2},1032,["content"])])]),f("div",So,k(c(tt).formatTimestampToZhDate(L._updatedAt)),1),f("div",{class:ye({selected:L._id===o.defaultConfigId})},k(L._id===o.defaultConfigId?c(d)("setting.picgo.picbed.selected.tip"):c(d)("setting.picgo.picbed.unselected.tip")),3)]),_:2},1024)],8,wo))),128)),f("div",{class:"profile-card-item",onClick:b},"+")]),f("div",ko,[p(I,{class:"set-default-btn",type:"success",disabled:c(l).defaultPicBed===s.value,onClick:H[0]||(H[0]=L=>J(s.value))},{default:m(()=>[E(k(c(d)("setting.picgo.picbed.set.default")),1)]),_:1},8,["disabled"])])]))])])}}});const Oo=te(xo,[["__scopeId","data-v-05ea8767"]]),ae=n=>(We("data-v-a19da94f"),n=n(),De(),n),Uo={id:"page-body"},Lo={key:0,class:"page-head"},$o=ae(()=>f("div",{class:"flex items-center"},[f("span",{class:"text-large font-600 mr-3"},"Picgo 设置")],-1)),Eo={class:"page-content-box"},No={key:0,style:{"padding-right":"20px"}},To={class:"picgo-setting-tip"},Bo={style:{display:"inline-block"}},Ao={target:"_blank",href:"https://docs.publish.terwer.space/post/picgo-diagram-bed-use-zxqqec.html"},Mo=ae(()=>f("a",{href:"https://picgo.github.io/PicGo-Core-Doc/zh/guide/config.html#%E6%89%8B%E5%8A%A8%E7%94%9F%E6%88%90"},"PicGO 官方文档",-1)),Wo={class:"version-tip"},Do=ae(()=>f("a",{href:"https://github.com/terwer/zhi/tree/main/libs/zhi-picgo-core",target:"_blank"},"zhi-picgo-core",-1)),Go=ae(()=>f("a",{href:"https://github.com/terwer",target:"_blank"},"terwer",-1)),Vo=ae(()=>f("a",{href:"https://github.com/PicGo/PicGo-Core",target:"_blank"},"PicGo-Core",-1)),Ro=ae(()=>f("p",null,"特别提示：picgo插件未经过全量测试，不保证所有插件都能运行，目前已经测试可用的插件如下：",-1)),Fo=ae(()=>f("p",null,[f("a",{href:"https://github.com/terwer/picgo-plugin-watermark-elec"},"picgo-plugin-watermark-elec"),E(" 搜索关键词：watermark-elec ")],-1)),jo=ae(()=>f("p",null,[f("a",{href:"https://github.com/wayjam/picgo-plugin-s3"},"picgo-plugin-s3"),E(" 搜索关键词：s3 ")],-1)),qo=ae(()=>f("p",null,[f("a",{href:"https://github.com/Herbertzz/picgo-plugin-minio"},"picgo-plugin-minio"),E(" 搜索关键词：minio ")],-1)),Ho={key:1},zo={class:"picgo-browser-tip"},Jo=z({__name:"PicgoSetting",setup(n){const{t:e}=Q(),t=Se(),{query:i}=Te(),{isInSiyuanOrSiyuanNewWin:o}=ee(),s=j(!1),a=j(""),l=o(),d=j(i.showBack==="true"),g=()=>{s.value=!s.value},y=()=>{t.back()};return Re(()=>{a.value=S.getPicgoVersion()}),(u,P)=>{const w=je,r=Oo,_=ot,b=fo,B=go,N=st;return h(),x("div",Uo,[d.value?(h(),x("div",Lo,[p(w,{icon:c(Ve),title:"返回",onClick:y},{content:m(()=>[$o]),_:1},8,["icon"])])):Y("",!0),f("div",Eo,[c(l)?(h(),x("div",No,[p(N,{type:"border-card",onTabClick:g},{default:m(()=>[p(_,{label:c(e)("setting.picgo.picbed")},{default:m(()=>[p(r,{"is-reload":s.value},null,8,["is-reload"])]),_:1},8,["label"]),p(_,{label:c(e)("setting.picgo.picgo")},{default:m(()=>[p(b)]),_:1},8,["label"]),p(_,{label:c(e)("setting.picgo.plugin")},{default:m(()=>[p(B)]),_:1},8,["label"])]),_:1}),f("blockquote",To,[f("div",null,[E(k(c(e)("picgo.siyuan.tip"))+" 。 当前系统默认的 PicGO 配置文件为： ",1),f("pre",Bo,[f("code",null,k(c(S).getPicgoCfgPath()),1)]),E(" 。 多个图床中，只能有一个图床设置为默认。默认图床会在上传的时候自动生效。从 0.7.0+ 开始，单个图床支持多份配置切换，每个图床只能有一个选中的配置生效。 "+k(c(e)("setting.picgo.refer.to"))+" ",1),f("a",Ao,k(c(e)("setting.picgo.refer.to.online.doc")),1),E(" 或者 "),Mo,E(" 。 ")])]),f("div",Wo,[E(" 当前PicGo版本为 "),Do,E(" v"+k(a.value)+" ， 对 Electron 环境进行了更好的适配 ，由 ",1),Go,E(" 负责维护 。感谢原始 "),Vo,E(" 项目。 "),Ro,Fo,jo,qo])])):(h(),x("div",Ho,[f("div",zo,[f("p",null,k(c(e)("picgo.chrome.tip"))+" 。",1),f("p",null,k(c(e)("picgo.pic.setting.no.tip"))+" 。",1)])]))])])}}});const Ko=te(Jo,[["__scopeId","data-v-a19da94f"]]),Yo={id:"page-body"},Qo={key:0,class:"page-head"},Xo={class:"flex items-center"},Zo={class:"text-large font-600 mr-3"},es={class:"page-content-box"},ts=z({__name:"BackPage",props:{title:{type:String,default:""},hasBackEmit:{type:Boolean,default:!1}},emits:["backEmit"],setup(n,{emit:e}){const t=n,i=q("back-page");Q();const o=Se();Te();const{query:s}=Te(),a=j(s.showBack==="true"),l=()=>{e&&t.hasBackEmit?(i.info("using backEmit do back"),e("backEmit")):(i.warn("no backEmit, using router handle back"),o.back())};return(d,g)=>{const y=je;return h(),x("div",Yo,[a.value?(h(),x("div",Qo,[p(y,{icon:c(Ve),title:"返回",onClick:l},{content:m(()=>[f("div",Xo,[f("span",Zo,k(t.title),1)])]),_:1},8,["icon"])])):Y("",!0),f("div",es,[Ge(d.$slots,"default",{},void 0,!0)])])}}});const He=te(ts,[["__scopeId","data-v-6db82693"]]),ns=z({__name:"ExternalPicgoSetting",setup(n){const e=q("external-picgo-setting"),{t}=Q(),{getExternalPicgoSetting:i,updateExternalPicgoSetting:o}=Le(),s=ie({extPicgoCfg:{}}),a=async()=>{await o(s.extPicgoCfg),A.success(t("main.opt.success"))};return Ce(async()=>{s.extPicgoCfg=await i(),e.debug("extPicgoCfg =>",s.extPicgoCfg)}),(l,d)=>{const g=re,y=Ie,u=se,P=xe,w=He;return h(),R(w,{title:"外部PicGO设置"},{default:m(()=>[p(P,{"label-width":"125px",class:"external-setting-form"},{default:m(()=>[p(y,{label:c(t)("setting.picgo.external.setting.apiurl")},{default:m(()=>[p(g,{modelValue:s.extPicgoCfg.extPicgoApiUrl,"onUpdate:modelValue":d[0]||(d[0]=r=>s.extPicgoCfg.extPicgoApiUrl=r),placeholder:c(t)("setting.picgo.external.setting.apiurl.tip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),p(y,null,{default:m(()=>[p(u,{type:"primary",onClick:a},{default:m(()=>[E(k(c(t)("main.opt.save")),1)]),_:1})]),_:1})]),_:1})]),_:1})}}});const is=te(ns,[["__scopeId","data-v-82f88cc7"]]),os=z({__name:"SiyuanSetting",setup(n){const{t:e}=Q(),{getSiyuanSetting:t}=pt(),i=t();return(o,s)=>{const a=re,l=Ie,d=xe,g=He;return h(),R(g,{title:"思源笔记设置"},{default:m(()=>[p(d,{"label-width":"125px",class:"siyuan-setting-form"},{default:m(()=>[p(l,{label:c(e)("setting.blog.siyuan.apiurl"),prop:"apiUrl"},{default:m(()=>[p(a,{modelValue:c(i).apiUrl,"onUpdate:modelValue":s[0]||(s[0]=y=>c(i).apiUrl=y),autocomplete:"off",placeholder:c(e)("setting.blog.siyuan.apiurl.tip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),p(l,{label:c(e)("setting.blog.siyuan.password"),prop:"pwd"},{default:m(()=>[p(a,{modelValue:c(i).password,"onUpdate:modelValue":s[1]||(s[1]=y=>c(i).password=y),type:"password",autocomplete:"off",placeholder:c(e)("setting.blog.siyuan.password.tip"),"show-password":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})}}});const ss=te(os,[["__scopeId","data-v-979d5a31"]]),as={class:"card-header"},cs=z({__name:"ImportData",setup(n){const{t:e}=Q(),{isInSiyuanOrSiyuanNewWin:t}=ee(),i=t(),o=async()=>{await S.importPicgoCfg()};return(s,a)=>{const l=se,d=me,g=Oe;return h(),x("div",null,[c(i)?(h(),R(g,{key:0,class:"box-card"},{header:m(()=>[f("div",as,[p(l,{type:"warning",onClick:o},{default:m(()=>[E(k(c(e)("setting.conf.import.picgo")),1)]),_:1})])]),default:m(()=>[p(d,{title:c(e)("setting.conf.import.picgo.tip"),type:"warning",closable:!1},null,8,["title"])]),_:1})):Y("",!0)])}}});const ls=te(cs,[["__scopeId","data-v-c3f042f6"]]),gs={class:"card-header"},rs=z({__name:"ExportData",setup(n){const{t:e}=Q(),{isInSiyuanOrSiyuanNewWin:t}=ee(),i=t(),o=()=>{S.backupPicgoCfg()};return(s,a)=>{const l=se,d=me,g=Oe;return h(),x("div",null,[c(i)?(h(),R(g,{key:0,class:"box-card"},{header:m(()=>[f("div",gs,[p(l,{type:"primary",onClick:o},{default:m(()=>[E(k(c(e)("setting.conf.export.picgo")),1)]),_:1})])]),default:m(()=>[p(d,{title:c(e)("setting.conf.export.syp.tip"),type:"success",closable:!1},null,8,["title"])]),_:1})):Y("",!0)])}}});const ps=te(rs,[["__scopeId","data-v-1c185271"]]),us={class:"card-header"},ds=z({__name:"ClearData",setup(n){const{t:e}=Q(),{isInSiyuanOrSiyuanNewWin:t}=ee(),i=t(),o=()=>{ke.confirm(e("main.opt.warning.tip"),e("main.opt.warning"),{confirmButtonText:e("main.opt.ok"),cancelButtonText:e("main.opt.cancel"),type:"warning"}).then(async()=>{S.clearPicgoCfg(),oe.reloadPageWithMessageCallback(e("main.opt.success"),void 0)}).catch(()=>{})};return(s,a)=>{const l=se,d=me,g=Oe;return h(),x("div",null,[c(i)?(h(),R(g,{key:0,class:"box-card"},{header:m(()=>[f("div",us,[p(l,{type:"danger",onClick:o},{default:m(()=>[E(k(c(e)("setting.conf.clear.picgo")),1)]),_:1})])]),default:m(()=>[p(d,{title:c(e)("setting.conf.clear.picgo.tip"),type:"error",closable:!1},null,8,["title"])]),_:1})):Y("",!0)])}}}),fs=z({__name:"TransportSelect",setup(n){const{t:e}=Q(),t=j("export");return(i,o)=>{const s=ot,a=st,l=He;return h(),R(l,{title:"PicGO配置导入导入"},{default:m(()=>[p(a,{modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=d=>t.value=d),class:"transport-tabs"},{default:m(()=>[p(s,{label:c(e)("setting.conf.export"),name:"export"},{default:m(()=>[p(ps)]),_:1},8,["label"]),p(s,{label:c(e)("setting.conf.import"),name:"import"},{default:m(()=>[p(ls)]),_:1},8,["label"]),p(s,{label:c(e)("setting.conf.clear"),name:"clear"},{default:m(()=>[p(ds)]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1})}}}),ms=[{path:"/",component:_i},{path:"/setting",component:Ko},{path:"/setting/external",component:is},{path:"/setting/transport",component:fs},{path:"/setting/siyuan",component:ss}],_s=()=>an({history:cn(),routes:ms}),hs={"setting.picgo.refer.to":"详情请参考：","setting.picgo.refer.to.online.doc":"PicGO配置在线文档","setting.picgo.picbed":"图床设置","setting.picgo.picgo":"PicGO设置","setting.picgo.picgo.open.config.file":"打开配置文件","setting.picgo.picgo.click.to.open":"点击打开","setting.picgo.picgo.choose.showed.picbed":"请选择显示的图床","setting.picgo.picbed.selected.tip":"已选中","setting.picgo.picbed.unselected.tip":"未选中","setting.picgo.picbed.set.default":"设为默认图床","setting.picgo.picbed.current.selected.tip":"已选中图床：","setting.picgo.picbed.current.tip":"当前默认图床是：","setting.picgo.picbed.uploader.config.name":"图床配置名","setting.picgo.picbed.uploader.config.name.placeholder":"请输入配置名称","setting.picgo.config.name":"配置名称","setting.picgo.config.name.placeholder":"请输入配置名称","setting.picgo.index.tip":"注意：1、此处上传的图片不会自动插入文档中，请手动点击按钮复制链接，然后 Ctrl+V 粘贴到文档中。2、对于文档当中原本已经存在的本地图片，点击上传之后不会直接替换原始图片，只会存储本地图片与图床图片的映射信息，需要在发布文章时手动勾选【使用图床】才会进行临时链接替换，请知悉。这样做是为了不破坏其他地方对文档图片的处理。当然，您也可以手动复制图床链接，然后删除原图片，替换为图床图片。3、该图片列表仅展示此文档包含的图片。","setting.picgo.index.copy.link":"复制链接","setting.picgo.setting.timestamp.rename":"时间戳重命名","setting.picgo.setting.close":"关","setting.picgo.setting.open":"开","setting.picgo.setting.log.file":"日志文件","setting.picgo.plugin":"插件设置","setting.picgo.plugin.list":"插件列表","setting.picgo.plugin.import.local":"导入本地插件","setting.picgo.plugin.install":"安装","setting.picgo.plugin.installing":"安装中","setting.picgo.plugin.installed":"已安装","setting.picgo.plugin.doing.something":"进行中","setting.picgo.plugin.search.placeholder":"搜索npm上的PicGo插件，或者点击上方按钮查看优秀插件列表。推荐：watermark-elec、s3","setting.picgo.plugin.gui.not.implemented":"该插件未对可视化界面进行优化, 是否继续安装?","setting.picgo.setting.node.path":"Node安装路径","setting.picgo.setting.node.path.tip":"请输入Node安装完整路径，例如：/opt/node16/bin，Node版本>=16","setting.picgo.setting.node.registry":"NPM的registry","setting.picgo.setting.node.registry.tip":"国内推荐：https://registry.npmmirror.com","setting.picgo.setting.node.proxy":"NPM代理","setting.picgo.setting.node.proxy.tip":"一般可留空，如有特殊需求可设置自定义代理","setting.picgo.setting.config.tip":"注意：横线以上的属性会改变上传图片的行为，配置可自动保存。横线以下的属性仅仅在安装插件时用到，并且需要点击【确认】按钮才能保存。","setting.picgo.plugin.install.success":"插件已经成功安装，请清除搜索关键字刷新列表。点击插件对应【设置】图标可查看插件详情，并对插件进行自定义设置。如果是图床扩展，请关闭重新打开，然后启用图床并进行设置。","setting.picgo.plugin.uninstall":"卸载插件","setting.picgo.plugin.uninstall.success":"插件已经成功卸载。","setting.picgo.plugin.enable":"启用插件","setting.picgo.plugin.disable":"禁用插件","setting.picgo.plugin.update":"更新插件","setting.picgo.plugin.config.setting":"插件设置","setting.picgo.plugin.work":"已兼容","setting.picgo.plugin.nowork":"不兼容","setting.picgo.plugin.nouse":"不可用","setting.picgo.plugin.update.success":"更新成功","setting.picgo.manage":"图床管理","picgo.chrome.tip":"您当前使用的是浏览器插件，需要从这里下载配置 PicGO 客户端：https://github.com/Molunerfinn/PicGo/releases","picgo.siyuan.tip":"您当前使用的是思源笔记PC客户端，PicGO已内置，只需配置即可","picgo.upload.status":"上传状态","picgo.upload.select.pic":"选择图片","picgo.upload.clipboard":"剪贴板图片","picgo.upload.onclick":"一键上传本地图片到图床","picgo.download.onclick":"一键下载远程图片到本地","picgo.download.local.to.bed":"上传本地图片到图床","picgo.download.bed.to.local":"下载远程图片到本地","picgo.pic.preview":"图片预览","picgo.pic.setting":"内置PicGO设置","picgo.pic.setting.no.tip":"由于您当前使用的是浏览器环境，无法直接集成 PicGO ，只能通过 HTTP 请求间接调用本地 PicGO 客户端上图片，请直接在本地 PicGO 客户端进行设置。如需体验更加完整的功能，请通过PC客户端使用。","syp.about":"关于作者","theme.mode.choose":"切换模式","theme.mode.dark":"暗黑模式","theme.mode.light":"浅色模式","setting.conf.export":"导出配置","setting.conf.import":"导入配置","setting.conf.clear":"清空配置","setting.conf.transport":"导入导出","main.opt.success":"操作成功","main.opt.failure":"操作失败","main.opt.edit":"编辑","main.opt.delete":"删除","main.opt.loading":"操作中...","main.opt.warning":"警告信息","main.opt.tip":"温馨提示","main.opt.save":"保存","main.opt.ok":"确认","main.opt.cancel":"取消","main.opt.warning.tip":"此操作不可恢复，是否继续？","switch.active.text":"调试模式","switch.unactive.text":"正常模式","setting.conf.import.picgo":"导入PicGO配置","setting.conf.export.syp.tip":"将导出对应的json配置文件，强烈建议定期进行配置备份。原则上支持向后兼容。如有不兼容问题，会特别说明。","setting.conf.export.picgo":"导出PicGO配置","setting.conf.import.picgo.tip":"请选择有效的历史备份json文件进行导入。注意：PicGO插件的注册信息不导入。为了配置的兼容性，请卸载所有插件之后，进行PicGO配置导出操作。卸载PicGO插件不会删除插件配置，只会删除插件文件以及插件注册记录。请放心卸载。","setting.conf.export.picgo.tip":"将导出对应的json配置文件，强烈建议定期进行配置备份。原则上支持向后兼容。如有不兼容问题，会特别说明。","setting.conf.clear.picgo":"清空PicGO配置","setting.conf.clear.picgo.tip":"清空配置不可恢复，请谨慎操作。强烈建议先备份配置。此操作会删除PicGO相关配置文件夹，包括配置、插件、缓存等，仅在PicGO加载发生异常，并且完全无法使用的时候使用，否则丢失配置后果自负！","picgo.type.switch.active.text":"切换到内置PicGO","picgo.type.switch.unactive.text":"切换到外部PicGO","picgo.type.external.title":"外部PicGO设置","setting.picgo.external.setting.apiurl":"API地址","setting.picgo.external.setting.apiurl.tip":"请输入外部外部PicGO的API地址，默认是：http://127.0.0.1:36677","siyuan.config.setting":"思源设置","setting.blog.siyuan.apiurl":"思源API地址","setting.blog.siyuan.apiurl.tip":"思源API地址，默认是：http://127.0.0.1:6806","setting.blog.siyuan.password":"思源Token","setting.blog.siyuan.password.tip":"思源Token，默认是空","form.validate.name.required":"请输入名称"},ys={"setting.picgo.refer.to":"For details, please refer to:","setting.picgo.refer.to.online.doc":"Picgo configuration online documentation","setting.picgo.picbed":"Picbed setting","setting.picgo.picgo":"PicGO setting","setting.picgo.picgo.open.config.file":"Open config file","setting.picgo.picgo.click.to.open":"Click open","setting.picgo.picgo.choose.showed.picbed":"Please select showed picbed","setting.picgo.picbed.selected.tip":"Selected","setting.picgo.picbed.unselected.tip":"Unselected","setting.picgo.picbed.set.default":"Set as default picbed","setting.picgo.picbed.current.selected.tip":"Current selected picbed is:","setting.picgo.picbed.current.tip":"Current picbed is:","setting.picgo.picbed.uploader.config.name":"Picbed config name","setting.picgo.picbed.uploader.config.name.placeholder":"Please input config name","setting.picgo.config.name":"Config name","setting.picgo.config.name.placeholder":"Please input config name","setting.picgo.index.tip":"Note: The image uploaded here will not be automatically inserted into the document. Please manually click the copy button to copy the link, and then Ctrl+V to paste it into the document. This picture list only shows the pictures contained in this document.","setting.picgo.index.copy.link":"Copy link","setting.picgo.setting.timestamp.rename":"Timestamp rename","setting.picgo.setting.close":"Close","setting.picgo.setting.open":"Open","setting.picgo.setting.log.file":"Log file","setting.picgo.plugin":"Plugin setting","setting.picgo.plugin.list":"Plugin list","setting.picgo.plugin.import.local":"Import local plugin","setting.picgo.plugin.install":"Install","setting.picgo.plugin.installing":"Installing","setting.picgo.plugin.installed":"Installed","setting.picgo.plugin.doing.something":"Loading","setting.picgo.plugin.search.placeholder":"Search the picgo plug -in on NPM, or click the button above to view the excellent plug -in list","setting.picgo.plugin.gui.not.implemented":"This plug -in does not optimize the visual interface, is it continued to be installed?","setting.picgo.setting.node.path":"Node install path","setting.picgo.setting.node.path.tip":"Please enter Node to install the full path, for example: /opt/node-v16.14.0-darwin-x64/bin, node version> = 16","setting.picgo.setting.node.registry":"NPM registry","setting.picgo.setting.node.registry.tip":"Mainland recommend：https://registry.npmmirror.com","setting.picgo.setting.node.proxy":"NPM proxy","setting.picgo.setting.node.proxy.tip":"Generally, you can leave empty. If you have special needs, you can set a custom agent","setting.picgo.setting.config.tip":"Note: The attributes above the horizontal line will change the behavior of uploading pictures, and the configuration can be stored automatically. The attribute below the horizontal line is only used when installing the plug -in, and you need to click the [Confirm] button to save.","setting.picgo.plugin.install.success":"The plug -in has been successfully installed, please clear the search keyword refresh list. Click the plug -in corresponding [Settings] icon to view the plug -in details and customize the plug -in","setting.picgo.plugin.uninstall":"Uninstall plugin","setting.picgo.plugin.uninstall.success":"Plugin is uninstalled successfully","setting.picgo.plugin.enable":"Enable plugin","setting.picgo.plugin.disable":"Disable plugin","setting.picgo.plugin.update":"Update plugin","setting.picgo.plugin.config.setting":"Plugin setting","setting.picgo.plugin.work":"Work","setting.picgo.plugin.nowork":"Nowork","setting.picgo.plugin.nouse":"Nouse","setting.picgo.plugin.update.success":"Update success","setting.picgo.manage":"Picture manage","picgo.chrome.tip":"If you are using a browser plug -in, you need to download the configuration Picgo client from here: https://github.com/Molunerfinn/PicGo/releases","picgo.siyuan.tip":"If you are using Siyuan notes pendants, you need to configure your own integration of PICGO. The pendant version of the PICGO configuration file is:`[Siyuan Workspace]/data/widgets/sy-post-publisher/lib/picgo/picgo.cfg.json`，Please refer to the official picgo document for configuration：https://picgo.github.io/PicGo-Core-Doc/zh/guide/config.html#%E6%89%8B%E5%8A%A8%E7%94%9F%E6%88%90","picgo.upload.status":"Upload status","picgo.upload.select.pic":"Select picture","picgo.upload.clipboard":"Clipboard picture","picgo.upload.onclick":"One click upload","picgo.download.onclick":"One click download","picgo.download.local.to.bed":"Upload picture to bed","picgo.download.bed.to.local":"Upload picture from bed","picgo.pic.preview":"Picture preview","picgo.pic.setting":"Picture setting","picgo.pic.setting.no.tip":"You are currently using the browser plug -in and cannot inherit PicGo. You can only call the local Picgo client on the local Picgo client through HTTP","syp.about":"About me","theme.mode.choose":"Mode","theme.mode.dark":"Dark mode","theme.mode.light":"Light mode","setting.conf.export":"Export config","setting.conf.import":"Import config","setting.conf.clear":"Clear config","setting.conf.transport":"Transport","main.opt.success":"Success","main.opt.failure":"Error","main.opt.edit":"Edit","main.opt.delete":"Delete","main.opt.loading":"In operation...","main.opt.warning":"Warn tips","main.opt.tip":"Kind tips","main.opt.save":"Save","main.opt.ok":"Confirm","main.opt.cancel":"Cancel","main.opt.warning.tip":"This operation cannot be undone, continue?","switch.active.text":"Debug","switch.unactive.text":"Normal","setting.conf.import.picgo":"Import PicGO configuration","setting.conf.export.syp.tip":"The corresponding json configuration file will be exported, and regular configuration backup is strongly recommended. In principle, backward compatibility is supported. If there is any incompatibility problem, it will be specially explained.","setting.conf.export.picgo":"Export PicGO configuration","setting.conf.import.picgo.tip":"Please select a valid historical backup json file to import. Note: PicGO plug-in registration information will not be imported. For configuration compatibility, please uninstall all plug-ins and then perform PicGO configuration export operation. Uninstalling PicGO plug-ins will not delete the plug-in configuration, only Plug-in files and plug-in registration records will be deleted. Please feel free to uninstall.","setting.conf.export.picgo.tip":"The corresponding json configuration file will be exported, and regular configuration backup is strongly recommended. In principle, backward compatibility is supported. If there is any incompatibility problem, it will be specially explained.","setting.conf.clear.picgo":"Clear PicGO configuration","setting.conf.clear.picgo.tip":"Empty configuration cannot be restored, please operate with caution. It is strongly recommended to back up the configuration first. This operation will delete PicGO related configuration folders, including configuration, plug-ins, cache, etc., and only use it when PicGO loads abnormally and cannot be used at all, otherwise Lost configuration at your own risk!","picgo.type.switch.active.text":"Use the built-in PicGO","picgo.type.switch.unactive.text":"Use an external PicGo","picgo.type.external.title":"External PicGO settings","setting.picgo.external.setting.apiurl":"API address","setting.picgo.external.setting.apiurl.tip":"Please enter the API address of the external external PicGO, the default is: http://127.0.0.1:36677","siyuan.config.setting":"Source settings","setting.blog.siyuan.apiurl":"Siyuan API address","setting.blog.siyuan.apiurl.tip":"The default address of Siyuan API is: http://127.0.0.1;6806","setting.blog.siyuan.password":"Siyuan Token","setting.blog.siyuan.password.tip":"Siyuan Token, which is empty by default","form.validate.name.required":"Please enter a name"},bs=kt({legacy:!1,locale:"zh_CN",fallbackLocale:"en_US",messages:{zh_CN:hs,en_US:ys}}),Ps={install(n){V.add(Nt),V.add(Tt),V.add(Bt),V.add(At),V.add(Mt),V.add(Wt),V.add(Dt),V.add(Gt),V.add(Vt),V.add(Rt),V.add(Ft),V.add(jt),V.add(qt),V.add(Ht),V.add(zt),V.add(Jt),V.add(Kt),V.add(Yt),V.add(Qt),V.add(Xt),V.add(Zt),V.add(en),V.add(tn),V.add(nn),n.component("font-awesome-icon",on)}},Qe=q("vue-main-entry"),ws=async()=>{const n=await Pe.getInstance();Qe.info("appInstance inited =>",n);const e=sn(qn),t=wn();e.use(t),e.use(bs),e.use(Ps);const i=_s();e.use(i),e.mount("#app"),Qe.info("vue app created")};(async()=>await ws())();
